import{$a as Of,$b as Cs,A as ff,Aa as Gr,Ac as Jr,B as Wa,Ba as Me,Bb as $f,Bc as lc,Ca as nc,Da as Ef,F as it,Fa as Tf,Ga as rc,Gb as qf,Gc as rp,H as kn,Ha as Af,I as Ut,Ia as wt,Ic as Yr,Jc as ip,K as Ka,Ka as ic,Kc as sp,L as On,La as sc,M as pf,Ma as Mn,Na as Ln,O as qr,Oa as bf,P as jt,Pa as Sf,Q as Ha,Qa as Rf,R as gf,Ra as Cf,S as Qa,Sa as Pf,Ta as Df,Ua as Nf,Va as on,W as Ja,X as Ke,Xa as kf,Xb as zf,Y as mf,Ya as Wr,Z as pe,_ as le,_a as Vn,a as M,aa as Z,ac as Gf,b as Te,ba as Ss,bc as Ps,c as af,ca as yf,cc as Wf,d as R,da as ce,db as xf,dc as ac,e as cf,ea as Ya,eb as Mf,ec as Kr,f as Ua,fa as J,fb as Lf,fc as Hr,g as Nn,ga as V,gb as Vf,gc as Kf,h as ja,ha as et,hc as Ds,i as Ba,ia as vf,j as Vt,ja as zr,jc as cc,k as We,ka as _f,kb as Ff,kc as Hf,l as uf,la as Rs,lb as Uf,lc as Qf,m as lf,ma as Xa,mb as oc,mc as Jf,n as Ft,na as It,nc as Ns,o as $a,oa as If,p as qa,pa as xn,q as za,qa as tt,qb as jf,r as xe,ra as Za,rb as Bf,rc as Yf,s as U,sc as uc,t as $r,tc as Xf,u as hf,uc as Zf,v as df,vc as Ve,w as Q,wa as ec,wc as ep,x as bs,xa as wf,xc as Qr,y as je,ya as sn,yc as tp,z as Ga,za as tc,zc as np}from"./chunk-6UWZEVHL.js";var dc=class{};var an=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),a=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(c=>s.indexOf(c)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var fc=class{encodeKey(e){return op(e)}encodeValue(e){return op(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function jv(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(a)||[];l.push(c),t.set(a,l)}),t}var Bv=/%(\d[a-f0-9])/gi,$v={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function op(n){return encodeURIComponent(n).replace(Bv,(e,t)=>$v[t]??e)}function ks(n){return`${n}`}var Bt=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new fc,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=jv(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(ks):[ks(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(ks(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(ks(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var pc=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function qv(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function ap(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function cp(n){return typeof Blob<"u"&&n instanceof Blob}function up(n){return typeof FormData<"u"&&n instanceof FormData}function zv(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Xr=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(qv(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new an,this.context??=new pc,!this.params)this.params=new Bt,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||ap(this.body)||cp(this.body)||up(this.body)||zv(this.body)?this.body:this.body instanceof Bt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||up(this.body)?null:cp(this.body)?this.body.type||null:ap(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Bt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,h=e.headers||this.headers,p=e.params||this.params,m=e.context??this.context;return e.setHeaders!==void 0&&(h=Object.keys(e.setHeaders).reduce((_,b)=>_.set(b,e.setHeaders[b]),h)),e.setParams&&(p=Object.keys(e.setParams).reduce((_,b)=>_.set(b,e.setParams[b]),p)),new n(t,r,a,{params:p,headers:h,context:m,reportProgress:l,responseType:i,withCredentials:c,transferCache:s})}},yp=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(yp||{}),gc=class{constructor(e,t=200,r="OK"){this.headers=e.headers||new an,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}};var Zr=class n extends gc{constructor(e={}){super(e),this.type=yp.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}};function hc(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var SS=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let a;if(r instanceof Xr)a=r;else{let h;s.headers instanceof an?h=s.headers:h=new an(s.headers);let p;s.params&&(s.params instanceof Bt?p=s.params:p=new Bt({fromObject:s.params})),a=new Xr(r,i,s.body!==void 0?s.body:null,{headers:h,context:s.context,params:p,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let c=U(a).pipe(Ut(h=>this.handler.handle(h)));if(r instanceof Xr||s.observe==="events")return c;let l=c.pipe(it(h=>h instanceof Zr));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return l.pipe(Q(h=>{if(h.body!==null&&!(h.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return h.body}));case"blob":return l.pipe(Q(h=>{if(h.body!==null&&!(h.body instanceof Blob))throw new Error("Response is not a Blob.");return h.body}));case"text":return l.pipe(Q(h=>{if(h.body!==null&&typeof h.body!="string")throw new Error("Response is not a string.");return h.body}));case"json":default:return l.pipe(Q(h=>h.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Bt().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,hc(s,i))}post(r,i,s={}){return this.request("POST",r,hc(s,i))}put(r,i,s={}){return this.request("PUT",r,hc(s,i))}};e.\u0275fac=function(i){return new(i||e)(J(dc))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();var Gv=new ce("");var Wv=new ce(""),lp="b",hp="h",dp="s",fp="st",pp="u",gp="rt",Os=new ce(""),Kv=["GET","HEAD"];function Hv(n,e){let b=V(Os),{isCacheActive:t}=b,r=af(b,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||i===!1||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!Kv.includes(s)||!r.includeRequestsWithAuthHeaders&&Qv(n)||r.filter?.(n)===!1)return e(n);let a=V(sc),c=V(Wv,{optional:!0}),l=Yr(V(wt));if(c&&!l)throw new le(2803,!1);let h=l&&c?Zv(n.url,c):n.url,p=Yv(n,h),m=a.get(p,null),_=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(_=i.includeHeaders),m){let{[lp]:C,[gp]:O,[hp]:D,[dp]:B,[fp]:z,[pp]:G}=m,re=C;switch(O){case"arraybuffer":re=new TextEncoder().encode(C).buffer;break;case"blob":re=new Blob([C]);break}let we=new an(D);return U(new Zr({body:re,headers:we,status:B,statusText:z,url:G}))}return e(n).pipe(pe(C=>{C instanceof Zr&&l&&a.set(p,{[lp]:C.body,[hp]:Jv(C.headers,_),[dp]:C.status,[fp]:C.statusText,[pp]:h,[gp]:n.responseType})}))}function Qv(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function Jv(n,e){if(!e)return{};let t={};for(let r of e){let i=n.getAll(r);i!==null&&(t[r]=i)}return t}function mp(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function Yv(n,e){let{params:t,method:r,responseType:i}=n,s=mp(t),a=n.serializeBody();a instanceof URLSearchParams?a=mp(a):typeof a!="string"&&(a="");let c=[r,i,e,a,s].join("|"),l=Xv(c);return l}function Xv(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function vp(n){return[{provide:Os,useFactory:()=>(Vf("NgHttpTransferCache"),M({isCacheActive:!0},n))},{provide:Gv,useValue:Hv,multi:!0,deps:[sc,Os]},{provide:Kr,multi:!0,useFactory:()=>{let e=V(Hr),t=V(Os);return()=>{Kf(e).then(()=>{t.isCacheActive=!1})}}}]}function Zv(n,e){let t=new URL(n,"resolve://").origin,r=e[t];return r?n.replace(t,r):n}var _c=class extends Zf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ic=class n extends _c{static makeCurrent(){Xf(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=t_();return t==null?null:n_(t)}resetBaseElement(){ei=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return lc(document.cookie,e)}},ei=null;function t_(){return ei=ei||document.querySelector("base"),ei?ei.getAttribute("href"):null}function n_(n){return new URL(n,document.baseURI).pathname}var r_=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),xs=new ce(""),Ep=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(a=>a.supports(r)),!i)throw new le(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(J(xs),J(Me))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),ti=class{constructor(e){this._doc=e}},yc="ng-app-id",Tp=(()=>{let e=class e{constructor(r,i,s,a={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Yr(a),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${yc}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let a=s.get(r);return a.usage+=i,a.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,a=s?.get(i);if(a?.parentNode===r)return s.delete(i),a.removeAttribute(yc),a;{let c=this.doc.createElement("style");return this.nonce&&c.setAttribute("nonce",this.nonce),c.textContent=i,this.platformIsServer&&c.setAttribute(yc,this.appId),r.appendChild(c),c}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),a=this.styleRef,c=a.get(i)?.elements;c?c.push(s):a.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(J(Ve),J(rc),J(ic,8),J(wt))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),vc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Tc=/%COMP%/g,Ap="%COMP%",i_=`_nghost-${Ap}`,s_=`_ngcontent-${Ap}`,o_=!0,a_=new ce("",{providedIn:"root",factory:()=>o_});function c_(n){return s_.replace(Tc,n)}function u_(n){return i_.replace(Tc,n)}function bp(n,e){return e.map(t=>t.replace(Tc,n))}var _p=(()=>{let e=class e{constructor(r,i,s,a,c,l,h,p=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=a,this.doc=c,this.platformId=l,this.ngZone=h,this.nonce=p,this.rendererByCompId=new Map,this.platformIsServer=Yr(l),this.defaultRenderer=new ni(r,c,h,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===zr.ShadowDom&&(i=Te(M({},i),{encapsulation:zr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Ms?s.applyToHost(r):s instanceof ri&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,a=s.get(i.id);if(!a){let c=this.doc,l=this.ngZone,h=this.eventManager,p=this.sharedStylesHost,m=this.removeStylesOnCompDestroy,_=this.platformIsServer;switch(i.encapsulation){case zr.Emulated:a=new Ms(h,p,i,this.appId,m,c,l,_);break;case zr.ShadowDom:return new wc(h,p,r,i,c,l,this.nonce,_);default:a=new ri(h,p,i,m,c,l,_);break}s.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(J(Ep),J(Tp),J(rc),J(a_),J(Ve),J(wt),J(Me),J(ic))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),ni=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(vc[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Ip(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Ip(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new le(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=vc[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=vc[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Wr.DashCase|Wr.Important)?e.style.setProperty(t,r,i&Wr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Wr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=uc().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Ip(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var wc=class extends ni{constructor(e,t,r,i,s,a,c,l){super(e,s,a,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=bp(i.id,i.styles);for(let p of h){let m=document.createElement("style");c&&m.setAttribute("nonce",c),m.textContent=p,this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ri=class extends ni{constructor(e,t,r,i,s,a,c,l){super(e,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?bp(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ms=class extends ri{constructor(e,t,r,i,s,a,c,l){let h=i+"-"+r.id;super(e,t,r,s,a,c,l,h),this.contentAttr=c_(h),this.hostAttr=u_(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},l_=(()=>{let e=class e extends ti{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(J(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),h_=(()=>{let e=class e extends ti{constructor(r){super(r),this.delegate=V(Qf,{optional:!0})}supports(r){return this.delegate?this.delegate.supports(r):!1}addEventListener(r,i,s){return this.delegate.addEventListener(r,i,s)}removeEventListener(r,i,s){return this.delegate.removeEventListener(r,i,s)}};e.\u0275fac=function(i){return new(i||e)(J(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),wp=["alt","control","meta","shift"],d_={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},f_={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},p_=(()=>{let e=class e extends ti{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let a=e.parseEventName(i),c=e.eventCallback(a.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>uc().onAndCancel(r,a.domEventName,c))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let a=e._normalizeKey(i.pop()),c="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),c="code."),wp.forEach(p=>{let m=i.indexOf(p);m>-1&&(i.splice(m,1),c+=p+".")}),c+=a,i.length!=0||a.length===0)return null;let h={};return h.domEventName=s,h.fullKey=c,h}static matchEventFullKeyCode(r,i){let s=d_[r.key]||r.key,a="";return i.indexOf("code.")>-1&&(s=r.code,a="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),wp.forEach(c=>{if(c!==s){let l=f_[c];l(r)&&(a+=c+".")}}),a+=s,a===i)}static eventCallback(r,i,s){return a=>{e.matchEventFullKeyCode(a,r)&&s.runGuarded(()=>i(a))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(J(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();function QS(n,e){return Hf(M({rootComponent:n},g_(e)))}function g_(n){return{appProviders:[...I_,...n?.providers??[]],platformProviders:__}}function m_(){Ic.makeCurrent()}function y_(){return new nc}function v_(){return Tf(document),document}var __=[{provide:wt,useValue:rp},{provide:Af,useValue:m_,multi:!0},{provide:Ve,useFactory:v_,deps:[]}];var I_=[{provide:If,useValue:"root"},{provide:nc,useFactory:y_,deps:[]},{provide:xs,useClass:l_,multi:!0,deps:[Ve,Me,wt]},{provide:xs,useClass:p_,multi:!0,deps:[Ve]},{provide:xs,useClass:h_,multi:!0},_p,Tp,Ep,{provide:xf,useExisting:_p},{provide:sp,useClass:r_,deps:[]},[]];var Sp=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(J(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var w_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:function(i){let s=null;return i?s=new(i||e):s=J(E_),s},providedIn:"root"});let n=e;return n})(),E_=(()=>{let e=class e extends w_{constructor(r){super(),this._doc=r}sanitize(r,i){if(i==null)return null;switch(r){case on.NONE:return i;case on.HTML:return Ln(i,"HTML")?Mn(i):Nf(this._doc,String(i)).toString();case on.STYLE:return Ln(i,"Style")?Mn(i):i;case on.SCRIPT:if(Ln(i,"Script"))return Mn(i);throw new le(5200,!1);case on.URL:return Ln(i,"URL")?Mn(i):Df(String(i));case on.RESOURCE_URL:if(Ln(i,"ResourceURL"))return Mn(i);throw new le(5201,!1);default:throw new le(5202,!1)}}bypassSecurityTrustHtml(r){return bf(r)}bypassSecurityTrustStyle(r){return Sf(r)}bypassSecurityTrustScript(r){return Rf(r)}bypassSecurityTrustUrl(r){return Cf(r)}bypassSecurityTrustResourceUrl(r){return Pf(r)}};e.\u0275fac=function(i){return new(i||e)(J(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ec=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n}(Ec||{});function JS(...n){let e=[],t=new Set,r=t.has(Ec.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);return It([[],Jf(),t.has(Ec.NoHttpTransferCache)||r?[]:vp({}),e])}var W="primary",vi=Symbol("RouteTitle"),Cc=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function qn(n){return new Cc(n)}function A_(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],c=n[s];if(a[0]===":")i[a.substring(1)]=c;else if(a!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function b_(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!st(n[t],e[t]))return!1;return!0}function st(n,e){let t=n?Pc(n):void 0,r=e?Pc(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Vp(n[i],e[i]))return!1;return!0}function Pc(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Vp(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Fp(n){return n.length>0?n[n.length-1]:null}function zt(n){return hf(n)?n:Wf(n)?xe(Promise.resolve(n)):U(n)}var S_={exact:jp,subset:Bp},Up={exact:R_,subset:C_,ignored:()=>!0};function Rp(n,e,t){return S_[t.paths](n.root,e.root,t.matrixParams)&&Up[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function R_(n,e){return st(n,e)}function jp(n,e,t){if(!un(n.segments,e.segments)||!Fs(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!jp(n.children[r],e.children[r],t))return!1;return!0}function C_(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Vp(n[t],e[t]))}function Bp(n,e,t){return $p(n,e,e.segments,t)}function $p(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!un(i,t)||e.hasChildren()||!Fs(i,t,r))}else if(n.segments.length===t.length){if(!un(n.segments,t)||!Fs(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Bp(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!un(n.segments,i)||!Fs(n.segments,i,r)||!n.children[W]?!1:$p(n.children[W],e,s,r)}}function Fs(n,e,t){return e.every((r,i)=>Up[t](n[i].parameters,r.parameters))}var Tt=class{constructor(e=new ne([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=qn(this.queryParams),this._queryParamMap}toString(){return N_.serialize(this)}},ne=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Us(this)}},cn=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=qn(this.parameters),this._parameterMap}toString(){return zp(this)}};function P_(n,e){return un(n,e)&&n.every((t,r)=>st(t.parameters,e[r].parameters))}function un(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function D_(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===W&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==W&&(t=t.concat(e(i,r)))}),t}var _i=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>new zn,providedIn:"root"});let n=e;return n})(),zn=class{parse(e){let t=new Nc(e);return new Tt(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ii(e.root,!0)}`,r=x_(e.queryParams),i=typeof e.fragment=="string"?`#${k_(e.fragment)}`:"";return`${t}${r}${i}`}},N_=new zn;function Us(n){return n.segments.map(e=>zp(e)).join("/")}function ii(n,e){if(!n.hasChildren())return Us(n);if(e){let t=n.children[W]?ii(n.children[W],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==W&&r.push(`${i}:${ii(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=D_(n,(r,i)=>i===W?[ii(n.children[W],!1)]:[`${i}:${ii(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[W]!=null?`${Us(n)}/${t[0]}`:`${Us(n)}/(${t.join("//")})`}}function qp(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ls(n){return qp(n).replace(/%3B/gi,";")}function k_(n){return encodeURI(n)}function Dc(n){return qp(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function js(n){return decodeURIComponent(n)}function Cp(n){return js(n.replace(/\+/g,"%20"))}function zp(n){return`${Dc(n.path)}${O_(n.parameters)}`}function O_(n){return Object.entries(n).map(([e,t])=>`;${Dc(e)}=${Dc(t)}`).join("")}function x_(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Ls(t)}=${Ls(i)}`).join("&"):`${Ls(t)}=${Ls(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var M_=/^[^\/()?;#]+/;function Ac(n){let e=n.match(M_);return e?e[0]:""}var L_=/^[^\/()?;=#]+/;function V_(n){let e=n.match(L_);return e?e[0]:""}var F_=/^[^=?&#]+/;function U_(n){let e=n.match(F_);return e?e[0]:""}var j_=/^[^&#]+/;function B_(n){let e=n.match(j_);return e?e[0]:""}var Nc=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ne([],{}):new ne([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[W]=new ne(e,t)),r}parseSegment(){let e=Ac(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new le(4009,!1);return this.capture(e),new cn(js(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=V_(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Ac(this.remaining);i&&(r=i,this.capture(r))}e[js(t)]=js(r)}parseQueryParam(e){let t=U_(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=B_(this.remaining);a&&(r=a,this.capture(r))}let i=Cp(t),s=Cp(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ac(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new le(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=W);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[W]:new ne([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new le(4011,!1)}};function Gp(n){return n.segments.length>0?new ne([],{[W]:n}):n}function Wp(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Wp(i);if(r===W&&s.segments.length===0&&s.hasChildren())for(let[a,c]of Object.entries(s.children))e[a]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ne(n.segments,e);return $_(t)}function $_(n){if(n.numberOfChildren===1&&n.children[W]){let e=n.children[W];return new ne(n.segments.concat(e.segments),e.children)}return n}function ln(n){return n instanceof Tt}function q_(n,e,t=null,r=null){let i=Kp(n);return Hp(i,e,t,r)}function Kp(n){let e;function t(s){let a={};for(let l of s.children){let h=t(l);a[l.outlet]=h}let c=new ne(s.url,a);return s===n&&(e=c),c}let r=t(n.root),i=Gp(r);return e??i}function Hp(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return bc(i,i,i,t,r);let s=z_(e);if(s.toRoot())return bc(i,i,new ne([],{}),t,r);let a=G_(s,i,n),c=a.processChildren?ai(a.segmentGroup,a.index,s.commands):Jp(a.segmentGroup,a.index,s.commands);return bc(i,a.segmentGroup,c,t,r)}function Bs(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function li(n){return typeof n=="object"&&n!=null&&n.outlets}function bc(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([l,h])=>{s[l]=Array.isArray(h)?h.map(p=>`${p}`):`${h}`});let a;n===e?a=t:a=Qp(n,e,t);let c=Gp(Wp(a));return new Tt(c,s,i)}function Qp(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Qp(s,e,t)}),new ne(n.segments,r)}var $s=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Bs(r[0]))throw new le(4003,!1);let i=r.find(li);if(i&&i!==Fp(r))throw new le(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function z_(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new $s(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,h])=>{c[l]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new $s(t,e,r)}var jn=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function G_(n,e,t){if(n.isAbsolute)return new jn(e,!0,0);if(!t)return new jn(e,!1,NaN);if(t.parent===null)return new jn(t,!0,0);let r=Bs(n.commands[0])?0:1,i=t.segments.length-1+r;return W_(t,i,n.numberOfDoubleDots)}function W_(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new le(4005,!1);i=r.segments.length}return new jn(r,!1,i-s)}function K_(n){return li(n[0])?n[0].outlets:{[W]:n}}function Jp(n,e,t){if(n??=new ne([],{}),n.segments.length===0&&n.hasChildren())return ai(n,e,t);let r=H_(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ne(n.segments.slice(0,r.pathIndex),{});return s.children[W]=new ne(n.segments.slice(r.pathIndex),n.children),ai(s,0,i)}else return r.match&&i.length===0?new ne(n.segments,{}):r.match&&!n.hasChildren()?kc(n,e,t):r.match?ai(n,0,i):kc(n,e,t)}function ai(n,e,t){if(t.length===0)return new ne(n.segments,{});{let r=K_(t),i={};if(Object.keys(r).some(s=>s!==W)&&n.children[W]&&n.numberOfChildren===1&&n.children[W].segments.length===0){let s=ai(n.children[W],e,t);return new ne(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=Jp(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new ne(n.segments,i)}}function H_(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],c=t[r];if(li(c))break;let l=`${c}`,h=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&h&&typeof h=="object"&&h.outlets===void 0){if(!Dp(l,h,a))return s;r+=2}else{if(!Dp(l,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function kc(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(li(s)){let l=Q_(s.outlets);return new ne(r,l)}if(i===0&&Bs(t[0])){let l=n.segments[e];r.push(new cn(l.path,Pp(t[0]))),i++;continue}let a=li(s)?s.outlets[W]:`${s}`,c=i<t.length-1?t[i+1]:null;a&&c&&Bs(c)?(r.push(new cn(a,Pp(c))),i+=2):(r.push(new cn(a,{})),i++)}return new ne(r,{})}function Q_(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=kc(new ne([],{}),0,r))}),e}function Pp(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Dp(n,e,t){return n==t.path&&st(e,t.parameters)}var ci="imperative",ve=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ve||{}),He=class{constructor(e,t){this.id=e,this.url=t}},Gn=class extends He{constructor(e,t,r="imperative",i=null){super(e,t),this.type=ve.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ot=class extends He{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=ve.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},$e=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}($e||{}),qs=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(qs||{}),Et=class extends He{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ve.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},$t=class extends He{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ve.NavigationSkipped}},hi=class extends He{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=ve.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},zs=class extends He{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ve.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Oc=class extends He{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ve.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xc=class extends He{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=ve.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Mc=class extends He{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ve.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lc=class extends He{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ve.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vc=class{constructor(e){this.route=e,this.type=ve.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Fc=class{constructor(e){this.route=e,this.type=ve.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Uc=class{constructor(e){this.snapshot=e,this.type=ve.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jc=class{constructor(e){this.snapshot=e,this.type=ve.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bc=class{constructor(e){this.snapshot=e,this.type=ve.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$c=class{constructor(e){this.snapshot=e,this.type=ve.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Gs=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=ve.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},di=class{},Wn=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function J_(n,e){return n.providers&&!n._injector&&(n._injector=oc(n.providers,e,`Route: ${n.path}`)),n._injector??e}function nt(n){return n.outlet||W}function Y_(n,e){let t=n.filter(r=>nt(r)===e);return t.push(...n.filter(r=>nt(r)!==e)),t}function Ii(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var qc=class{get injector(){return Ii(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new wi(this.rootInjector),this.attachRef=null}},wi=(()=>{let e=class e{constructor(r){this.rootInjector=r,this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new qc(this.rootInjector),this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)(J(xn))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ws=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=zc(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=zc(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Gc(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Gc(e,this._root).map(t=>t.value)}};function zc(n,e){if(n===e.value)return e;for(let t of e.children){let r=zc(n,t);if(r)return r}return null}function Gc(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Gc(n,t);if(r.length)return r.unshift(e),r}return[]}var Be=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Un(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ks=class extends Ws{constructor(e,t){super(e),this.snapshot=t,eu(this,e)}toString(){return this.snapshot.toString()}};function Yp(n){let e=X_(n),t=new We([new cn("",{})]),r=new We({}),i=new We({}),s=new We({}),a=new We(""),c=new qt(t,r,s,a,i,W,n,e.root);return c.snapshot=e.root,new Ks(new Be(c,[]),e)}function X_(n){let e={},t={},r={},i="",s=new Bn([],e,r,i,t,W,n,null,{});return new Qs("",new Be(s,[]))}var qt=class{constructor(e,t,r,i,s,a,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Q(h=>h[vi]))??U(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Q(e=>qn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Q(e=>qn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Hs(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:M(M({},e.params),n.params),data:M(M({},e.data),n.data),resolve:M(M(M(M({},n.data),e.data),i?.data),n._resolvedData)}:r={params:M({},n.params),data:M({},n.data),resolve:M(M({},n.data),n._resolvedData??{})},i&&Zp(i)&&(r.resolve[vi]=i.title),r}var Bn=class{get title(){return this.data?.[vi]}constructor(e,t,r,i,s,a,c,l,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=c,this.routeConfig=l,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=qn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=qn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Qs=class extends Ws{constructor(e,t){super(t),this.url=e,eu(this,t)}toString(){return Xp(this._root)}};function eu(n,e){e.value._routerState=n,e.children.forEach(t=>eu(n,t))}function Xp(n){let e=n.children.length>0?` { ${n.children.map(Xp).join(", ")} } `:"";return`${n.value}${e}`}function Sc(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,st(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),st(e.params,t.params)||n.paramsSubject.next(t.params),b_(e.url,t.url)||n.urlSubject.next(t.url),st(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Wc(n,e){let t=st(n.params,e.params)&&P_(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Wc(n.parent,e.parent))}function Zp(n){return typeof n.title=="string"||n.title===null}var Z_=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=W,this.activateEvents=new Gr,this.deactivateEvents=new Gr,this.attachEvents=new Gr,this.detachEvents=new Gr,this.parentContexts=V(wi),this.location=V(Lf),this.changeDetector=V(cc),this.inputBinder=V(Zs,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new le(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new le(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new le(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new le(4013,!1);this._activatedRoute=r;let s=this.location,c=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,h=new Kc(r,l,s.injector);this.activated=s.createComponent(c,{index:s.length,injector:h,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Xa({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Za]});let n=e;return n})(),Kc=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===qt?this.route:e===wi?this.childContexts:this.parent.get(e,t)}},Zs=new ce(""),Np=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=bs([i.queryParams,i.params,i.data]).pipe(Ke(([a,c,l],h)=>(l=M(M(M({},a),c),l),h===0?U(l):Promise.resolve(l)))).subscribe(a=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let c=Yf(i.component);if(!c){this.unsubscribeFromRouteData(r);return}for(let{templateName:l}of c.inputs)r.activatedComponentRef.setInput(l,a[l])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();function eI(n,e,t){let r=fi(n,e._root,t?t._root:void 0);return new Ks(r,e)}function fi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=tI(n,e,t);return new Be(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(c=>fi(n,c)),a}}let r=nI(e.value),i=e.children.map(s=>fi(n,s));return new Be(r,i)}}function tI(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return fi(n,r,i);return fi(n,r)})}function nI(n){return new qt(new We(n.url),new We(n.params),new We(n.queryParams),new We(n.fragment),new We(n.data),n.outlet,n.component,n)}var pi=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},eg="ngNavigationCancelingError";function Js(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ln(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=tg(!1,$e.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function tg(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[eg]=!0,t.cancellationCode=e,t}function rI(n){return ng(n)&&ln(n.url)}function ng(n){return!!n&&n[eg]}var iI=(n,e,t,r)=>Q(i=>(new Hc(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Hc=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Sc(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Un(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Un(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Un(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Un(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new $c(s.value.snapshot))}),e.children.length&&this.forwardEvent(new jc(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Sc(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),Sc(c.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,r)}},Ys=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},$n=class{constructor(e,t){this.component=e,this.route=t}};function sI(n,e,t){let r=n._root,i=e?e._root:null;return si(r,i,t,[r.value])}function oI(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Hn(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!yf(n)?n:e.get(n):r}function si(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Un(e);return n.children.forEach(a=>{aI(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,c])=>ui(c,t.getContext(a),i)),i}function aI(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let l=cI(a,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new Ys(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?si(n,e,c?c.children:null,r,i):si(n,e,t,r,i),l&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new $n(c.outlet.component,a))}else a&&ui(e,c,i),i.canActivateChecks.push(new Ys(r)),s.component?si(n,null,c?c.children:null,r,i):si(n,null,t,r,i);return i}function cI(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!un(n.url,e.url);case"pathParamsOrQueryParamsChange":return!un(n.url,e.url)||!st(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Wc(n,e)||!st(n.queryParams,e.queryParams);case"paramsChange":default:return!Wc(n,e)}}function ui(n,e,t){let r=Un(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?ui(a,e.children.getContext(s),t):ui(a,null,t):ui(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new $n(e.outlet.component,i)):t.canDeactivateChecks.push(new $n(null,i)):t.canDeactivateChecks.push(new $n(null,i))}function Ei(n){return typeof n=="function"}function uI(n){return typeof n=="boolean"}function lI(n){return n&&Ei(n.canLoad)}function hI(n){return n&&Ei(n.canActivate)}function dI(n){return n&&Ei(n.canActivateChild)}function fI(n){return n&&Ei(n.canDeactivate)}function pI(n){return n&&Ei(n.canMatch)}function rg(n){return n instanceof df||n?.name==="EmptyError"}var Vs=Symbol("INITIAL_VALUE");function Kn(){return Ke(n=>bs(n.map(e=>e.pipe(On(1),Ja(Vs)))).pipe(Q(e=>{for(let t of e)if(t!==!0){if(t===Vs)return Vs;if(t===!1||gI(t))return t}return!0}),it(e=>e!==Vs),On(1)))}function gI(n){return ln(n)||n instanceof pi}function mI(n,e){return je(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?U(Te(M({},t),{guardsResult:!0})):yI(a,r,i,n).pipe(je(c=>c&&uI(c)?vI(r,s,n,e):U(c)),Q(c=>Te(M({},t),{guardsResult:c})))})}function yI(n,e,t,r){return xe(n).pipe(je(i=>TI(i.component,i.route,t,e,r)),jt(i=>i!==!0,!0))}function vI(n,e,t,r){return xe(e).pipe(Ut(i=>ff(II(i.route.parent,r),_I(i.route,r),EI(n,i.path,t),wI(n,i.route,t))),jt(i=>i!==!0,!0))}function _I(n,e){return n!==null&&e&&e(new Bc(n)),U(!0)}function II(n,e){return n!==null&&e&&e(new Uc(n)),U(!0)}function wI(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>Wa(()=>{let a=Ii(e)??t,c=Hn(s,a),l=hI(c)?c.canActivate(e,n):tt(a,()=>c(e,n));return zt(l).pipe(jt())}));return U(i).pipe(Kn())}function EI(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>oI(a)).filter(a=>a!==null).map(a=>Wa(()=>{let c=a.guards.map(l=>{let h=Ii(a.node)??t,p=Hn(l,h),m=dI(p)?p.canActivateChild(r,n):tt(h,()=>p(r,n));return zt(m).pipe(jt())});return U(c).pipe(Kn())}));return U(s).pipe(Kn())}function TI(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let a=s.map(c=>{let l=Ii(e)??i,h=Hn(c,l),p=fI(h)?h.canDeactivate(n,e,t,r):tt(l,()=>h(n,e,t,r));return zt(p).pipe(jt())});return U(a).pipe(Kn())}function AI(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(a=>{let c=Hn(a,n),l=lI(c)?c.canLoad(e,t):tt(n,()=>c(e,t));return zt(l)});return U(s).pipe(Kn(),ig(r))}function ig(n){return Ua(pe(e=>{if(typeof e!="boolean")throw Js(n,e)}),Q(e=>e===!0))}function bI(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(a=>{let c=Hn(a,n),l=pI(c)?c.canMatch(e,t):tt(n,()=>c(e,t));return zt(l)});return U(s).pipe(Kn(),ig(r))}var gi=class{constructor(e){this.segmentGroup=e||null}},mi=class extends Error{constructor(e){super(),this.urlTree=e}};function Fn(n){return $r(new gi(n))}function SI(n){return $r(new le(4e3,!1))}function RI(n){return $r(tg(!1,$e.GuardRejected))}var Qc=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[W])return SI(`${e.redirectTo}`);i=i.children[W]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let c=t,{queryParams:l,fragment:h,routeConfig:p,url:m,outlet:_,params:b,data:C,title:O}=i,D=tt(s,()=>c({params:b,data:C,queryParams:l,fragment:h,routeConfig:p,url:m,outlet:_,title:O}));if(D instanceof Tt)throw new mi(D);t=D}let a=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new mi(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Tt(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([c,l])=>{a[c]=this.createSegmentGroup(e,l,r,i)}),new ne(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new le(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Jc={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function CI(n,e,t,r,i){let s=sg(n,e,t);return s.matched?(r=J_(e,r),bI(r,e,t,i).pipe(Q(a=>a===!0?s:M({},Jc)))):U(s)}function sg(n,e,t){if(e.path==="**")return PI(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?M({},Jc):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||A_)(t,n,e);if(!i)return M({},Jc);let s={};Object.entries(i.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let a=i.consumed.length>0?M(M({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function PI(n){return{matched:!0,parameters:n.length>0?Fp(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function kp(n,e,t,r){return t.length>0&&kI(n,t,r)?{segmentGroup:new ne(e,NI(r,new ne(t,n.children))),slicedSegments:[]}:t.length===0&&OI(n,t,r)?{segmentGroup:new ne(n.segments,DI(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ne(n.segments,n.children),slicedSegments:t}}function DI(n,e,t,r){let i={};for(let s of t)if(eo(n,e,s)&&!r[nt(s)]){let a=new ne([],{});i[nt(s)]=a}return M(M({},r),i)}function NI(n,e){let t={};t[W]=e;for(let r of n)if(r.path===""&&nt(r)!==W){let i=new ne([],{});t[nt(r)]=i}return t}function kI(n,e,t){return t.some(r=>eo(n,e,r)&&nt(r)!==W)}function OI(n,e,t){return t.some(r=>eo(n,e,r))}function eo(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function xI(n,e,t){return e.length===0&&!n.children[t]}var Yc=class{};function MI(n,e,t,r,i,s,a="emptyOnly"){return new Xc(n,e,t,r,i,a,s).recognize()}var LI=31,Xc=class{constructor(e,t,r,i,s,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.applyRedirects=new Qc(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new le(4002,`'${e.segmentGroup}'`)}recognize(){let e=kp(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Q(({children:t,rootSnapshot:r})=>{let i=new Be(r,t),s=new Qs("",i),a=q_(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),{state:s,tree:a}}))}match(e){let t=new Bn([],Object.freeze({}),Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),W,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,W,t).pipe(Q(r=>({children:r,rootSnapshot:t})),kn(r=>{if(r instanceof mi)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof gi?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(Q(a=>a instanceof Be?[a]:[]))}processChildren(e,t,r,i){let s=[];for(let a of Object.keys(r.children))a==="primary"?s.unshift(a):s.push(a);return xe(s).pipe(Ut(a=>{let c=r.children[a],l=Y_(t,a);return this.processSegmentGroup(e,l,c,a,i)}),Qa((a,c)=>(a.push(...c),a)),Ka(null),gf(),je(a=>{if(a===null)return Fn(r);let c=og(a);return VI(c),U(c)}))}processSegment(e,t,r,i,s,a,c){return xe(t).pipe(Ut(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,r,i,s,a,c).pipe(kn(h=>{if(h instanceof gi)return U(null);throw h}))),jt(l=>!!l),kn(l=>{if(rg(l))return xI(r,i,s)?U(new Yc):Fn(r);throw l}))}processSegmentAgainstRoute(e,t,r,i,s,a,c,l){return nt(r)!==a&&(a===W||!eo(i,s,r))?Fn(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a,l):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a,l):Fn(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a,c){let{matched:l,parameters:h,consumedSegments:p,positionalParamSegments:m,remainingSegments:_}=sg(t,i,s);if(!l)return Fn(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>LI&&(this.allowRedirects=!1));let b=new Bn(s,h,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,Op(i),nt(i),i.component??i._loadedComponent??null,i,xp(i)),C=Hs(b,c,this.paramsInheritanceStrategy);b.params=Object.freeze(C.params),b.data=Object.freeze(C.data);let O=this.applyRedirects.applyRedirectCommands(p,i.redirectTo,m,b,e);return this.applyRedirects.lineralizeSegments(i,O).pipe(je(D=>this.processSegment(e,r,t,D.concat(_),a,!1,c)))}matchSegmentAgainstRoute(e,t,r,i,s,a){let c=CI(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),c.pipe(Ke(l=>l.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ke(({routes:h})=>{let p=r._loadedInjector??e,{parameters:m,consumedSegments:_,remainingSegments:b}=l,C=new Bn(_,m,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,Op(r),nt(r),r.component??r._loadedComponent??null,r,xp(r)),O=Hs(C,a,this.paramsInheritanceStrategy);C.params=Object.freeze(O.params),C.data=Object.freeze(O.data);let{segmentGroup:D,slicedSegments:B}=kp(t,_,b,h);if(B.length===0&&D.hasChildren())return this.processChildren(p,h,D,C).pipe(Q(G=>new Be(C,G)));if(h.length===0&&B.length===0)return U(new Be(C,[]));let z=nt(r)===s;return this.processSegment(p,h,D,B,z?W:s,!0,C).pipe(Q(G=>new Be(C,G instanceof Be?[G]:[])))}))):Fn(t)))}getChildConfig(e,t,r){return t.children?U({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?U({routes:t._loadedRoutes,injector:t._loadedInjector}):AI(e,t,r,this.urlSerializer).pipe(je(i=>i?this.configLoader.loadChildren(e,t).pipe(pe(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):RI(t))):U({routes:[],injector:e})}};function VI(n){n.sort((e,t)=>e.value.outlet===W?-1:t.value.outlet===W?1:e.value.outlet.localeCompare(t.value.outlet))}function FI(n){let e=n.value.routeConfig;return e&&e.path===""}function og(n){let e=[],t=new Set;for(let r of n){if(!FI(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=og(r.children);e.push(new Be(r.value,i))}return e.filter(r=>!t.has(r))}function Op(n){return n.data||{}}function xp(n){return n.resolve||{}}function UI(n,e,t,r,i,s){return je(a=>MI(n,e,t,r,a.extractedUrl,i,s).pipe(Q(({state:c,tree:l})=>Te(M({},a),{targetSnapshot:c,urlAfterRedirects:l}))))}function jI(n,e){return je(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return U(t);let s=new Set(i.map(l=>l.route)),a=new Set;for(let l of s)if(!a.has(l))for(let h of ag(l))a.add(h);let c=0;return xe(a).pipe(Ut(l=>s.has(l)?BI(l,r,n,e):(l.data=Hs(l,l.parent,n).resolve,U(void 0))),pe(()=>c++),Ha(1),je(l=>c===a.size?U(t):Ft))})}function ag(n){let e=n.children.map(t=>ag(t)).flat();return[n,...e]}function BI(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Zp(i)&&(s[vi]=i.title),$I(s,n,e,r).pipe(Q(a=>(n._resolvedData=a,n.data=Hs(n,n.parent,t).resolve,null)))}function $I(n,e,t,r){let i=Pc(n);if(i.length===0)return U({});let s={};return xe(i).pipe(je(a=>qI(n[a],e,t,r).pipe(jt(),pe(c=>{if(c instanceof pi)throw Js(new zn,c);s[a]=c}))),Ha(1),pf(s),kn(a=>rg(a)?Ft:$r(a)))}function qI(n,e,t,r){let i=Ii(e)??r,s=Hn(n,i),a=s.resolve?s.resolve(e,t):tt(i,()=>s(e,t));return zt(a)}function Rc(n){return Ke(e=>{let t=n(e);return t?xe(t).pipe(Q(()=>e)):U(e)})}var cg=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(a=>a.outlet===W);return i}getResolvedTitleForRoute(r){return r.data[vi]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>V(zI),providedIn:"root"});let n=e;return n})(),zI=(()=>{let e=class e extends cg{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(J(Sp))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ti=new ce("",{providedIn:"root",factory:()=>({})}),GI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=_f({type:e,selectors:[["ng-component"]],standalone:!0,features:[zf],decls:1,vars:0,template:function(i,s){i&1&&$f(0,"router-outlet")},dependencies:[Z_],encapsulation:2});let n=e;return n})();function tu(n){let e=n.children&&n.children.map(tu),t=e?Te(M({},n),{children:e}):M({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==W&&(t.component=GI),t}var yi=new ce(""),nu=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=V(Ds)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=zt(r.loadComponent()).pipe(Q(ug),pe(a=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=a}),qr(()=>{this.componentLoaders.delete(r)})),s=new Ba(i,()=>new Vt).pipe(ja());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let a=WI(i,this.compiler,r,this.onLoadEndListener).pipe(qr(()=>{this.childrenLoaders.delete(i)})),c=new Ba(a,()=>new Vt).pipe(ja());return this.childrenLoaders.set(i,c),c}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function WI(n,e,t,r){return zt(n.loadChildren()).pipe(Q(ug),je(i=>i instanceof Uf||Array.isArray(i)?U(i):xe(e.compileModuleAsync(i))),Q(i=>{r&&r(n);let s,a,c=!1;return Array.isArray(i)?(a=i,c=!0):(s=i.create(t).injector,a=s.get(yi,[],{optional:!0,self:!0}).flat()),{routes:a.map(tu),injector:s}}))}function KI(n){return n&&typeof n=="object"&&"default"in n}function ug(n){return KI(n)?n.default:n}var ru=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>V(HI),providedIn:"root"});let n=e;return n})(),HI=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),lg=new ce(""),hg=new ce("");function QI(n,e,t){let r=n.get(hg),i=n.get(Ve);return n.get(Me).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(h=>setTimeout(h));let s,a=new Promise(h=>{s=h}),c=i.startViewTransition(()=>(s(),JI(n))),{onViewTransitionCreated:l}=r;return l&&tt(n,()=>l({transition:c,from:e,to:t})),a})}function JI(n){return new Promise(e=>{jf({read:()=>setTimeout(e)},{injector:n})})}var YI=new ce(""),iu=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Vt,this.transitionAbortSubject=new Vt,this.configLoader=V(nu),this.environmentInjector=V(xn),this.urlSerializer=V(_i),this.rootContexts=V(wi),this.location=V(Jr),this.inputBindingEnabled=V(Zs,{optional:!0})!==null,this.titleStrategy=V(cg),this.options=V(Ti,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=V(ru),this.createViewTransition=V(lg,{optional:!0}),this.navigationErrorHandler=V(YI,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Vc(s)),i=s=>this.events.next(new Fc(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Te(M(M({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new We({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:ci,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(it(a=>a.id!==0),Q(a=>Te(M({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),Ke(a=>{let c=!1,l=!1;return U(a).pipe(Ke(h=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",$e.SupersededByNewNavigation),Ft;this.currentTransition=a,this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,targetBrowserUrl:typeof h.extras.browserUrl=="string"?this.urlSerializer.parse(h.extras.browserUrl):h.extras.browserUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?Te(M({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let p=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),m=h.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!p&&m!=="reload"){let _="";return this.events.next(new $t(h.id,this.urlSerializer.serialize(h.rawUrl),_,qs.IgnoredSameUrlNavigation)),h.resolve(!1),Ft}if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return U(h).pipe(Ke(_=>{let b=this.transitions?.getValue();return this.events.next(new Gn(_.id,this.urlSerializer.serialize(_.extractedUrl),_.source,_.restoredState)),b!==this.transitions?.getValue()?Ft:Promise.resolve(_)}),UI(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),pe(_=>{a.targetSnapshot=_.targetSnapshot,a.urlAfterRedirects=_.urlAfterRedirects,this.currentNavigation=Te(M({},this.currentNavigation),{finalUrl:_.urlAfterRedirects});let b=new zs(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot);this.events.next(b)}));if(p&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){let{id:_,extractedUrl:b,source:C,restoredState:O,extras:D}=h,B=new Gn(_,this.urlSerializer.serialize(b),C,O);this.events.next(B);let z=Yp(this.rootComponentType).snapshot;return this.currentTransition=a=Te(M({},h),{targetSnapshot:z,urlAfterRedirects:b,extras:Te(M({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=b,U(a)}else{let _="";return this.events.next(new $t(h.id,this.urlSerializer.serialize(h.extractedUrl),_,qs.IgnoredByUrlHandlingStrategy)),h.resolve(!1),Ft}}),pe(h=>{let p=new Oc(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}),Q(h=>(this.currentTransition=a=Te(M({},h),{guards:sI(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),a)),mI(this.environmentInjector,h=>this.events.next(h)),pe(h=>{if(a.guardsResult=h.guardsResult,h.guardsResult&&typeof h.guardsResult!="boolean")throw Js(this.urlSerializer,h.guardsResult);let p=new xc(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.events.next(p)}),it(h=>h.guardsResult?!0:(this.cancelNavigationTransition(h,"",$e.GuardRejected),!1)),Rc(h=>{if(h.guards.canActivateChecks.length)return U(h).pipe(pe(p=>{let m=new Mc(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}),Ke(p=>{let m=!1;return U(p).pipe(jI(this.paramsInheritanceStrategy,this.environmentInjector),pe({next:()=>m=!0,complete:()=>{m||this.cancelNavigationTransition(p,"",$e.NoDataFromResolver)}}))}),pe(p=>{let m=new Lc(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}))}),Rc(h=>{let p=m=>{let _=[];m.routeConfig?.loadComponent&&!m.routeConfig._loadedComponent&&_.push(this.configLoader.loadComponent(m.routeConfig).pipe(pe(b=>{m.component=b}),Q(()=>{})));for(let b of m.children)_.push(...p(b));return _};return bs(p(h.targetSnapshot.root)).pipe(Ka(null),On(1))}),Rc(()=>this.afterPreactivation()),Ke(()=>{let{currentSnapshot:h,targetSnapshot:p}=a,m=this.createViewTransition?.(this.environmentInjector,h.root,p.root);return m?xe(m).pipe(Q(()=>a)):U(a)}),Q(h=>{let p=eI(r.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return this.currentTransition=a=Te(M({},h),{targetRouterState:p}),this.currentNavigation.targetRouterState=p,a}),pe(()=>{this.events.next(new di)}),iI(this.rootContexts,r.routeReuseStrategy,h=>this.events.next(h),this.inputBindingEnabled),On(1),pe({next:h=>{c=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ot(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)},complete:()=>{c=!0}}),mf(this.transitionAbortSubject.pipe(pe(h=>{throw h}))),qr(()=>{!c&&!l&&this.cancelNavigationTransition(a,"",$e.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),kn(h=>{if(l=!0,ng(h))this.events.next(new Et(a.id,this.urlSerializer.serialize(a.extractedUrl),h.message,h.cancellationCode)),rI(h)?this.events.next(new Wn(h.url,h.navigationBehaviorOptions)):a.resolve(!1);else{let p=new hi(a.id,this.urlSerializer.serialize(a.extractedUrl),h,a.targetSnapshot??void 0);try{let m=tt(this.environmentInjector,()=>this.navigationErrorHandler?.(p));if(m instanceof pi){let{message:_,cancellationCode:b}=Js(this.urlSerializer,m);this.events.next(new Et(a.id,this.urlSerializer.serialize(a.extractedUrl),_,b)),this.events.next(new Wn(m.redirectTo,m.navigationBehaviorOptions))}else{this.events.next(p);let _=r.errorHandler(h);a.resolve(!!_)}}catch(m){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(m)}}return Ft}))}))}cancelNavigationTransition(r,i,s){let a=new Et(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(a),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let r=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return r.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function XI(n){return n!==ci}var ZI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>V(ew),providedIn:"root"});let n=e;return n})(),Zc=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},ew=(()=>{let e=class e extends Zc{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ec(e)))(s||e)}})(),e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),dg=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>V(tw),providedIn:"root"});let n=e;return n})(),tw=(()=>{let e=class e extends dg{constructor(){super(...arguments),this.location=V(Jr),this.urlSerializer=V(_i),this.options=V(Ti,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=V(ru),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Tt,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Yp(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Gn)this.stateMemento=this.createStateMemento();else if(r instanceof $t)this.rawUrlTree=i.initialUrl;else if(r instanceof zs){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??s,i)}}else r instanceof di?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):r instanceof Et&&(r.code===$e.GuardRejected||r.code===$e.NoDataFromResolver)?this.restoreHistory(i):r instanceof hi?this.restoreHistory(i,!0):r instanceof ot&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=r instanceof Tt?this.urlSerializer.serialize(r):r;if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let a=this.browserPageId,c=M(M({},i.extras.state),this.generateNgRouterState(i.id,a));this.location.replaceState(s,"",c)}else{let a=M(M({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===r.finalUrl&&a===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ec(e)))(s||e)}})(),e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),oi=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(oi||{});function fg(n,e){n.events.pipe(it(t=>t instanceof ot||t instanceof Et||t instanceof hi||t instanceof $t),Q(t=>t instanceof ot||t instanceof $t?oi.COMPLETE:(t instanceof Et?t.code===$e.Redirect||t.code===$e.SupersededByNewNavigation:!1)?oi.REDIRECTING:oi.FAILED),it(t=>t!==oi.REDIRECTING),On(1)).subscribe(()=>{e()})}function nw(n){throw n}var rw={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},iw={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},At=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=V(Ps),this.stateManager=V(dg),this.options=V(Ti,{optional:!0})||{},this.pendingTasks=V(tc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=V(iu),this.urlSerializer=V(_i),this.location=V(Jr),this.urlHandlingStrategy=V(ru),this._events=new Vt,this.errorHandler=this.options.errorHandler||nw,this.navigated=!1,this.routeReuseStrategy=V(ZI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=V(yi,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!V(Zs,{optional:!0}),this.eventsSubscription=new cf,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Et&&i.code!==$e.Redirect&&i.code!==$e.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ot)this.navigated=!0;else if(i instanceof Wn){let c=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),h=M({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||XI(s.source)},c);this.scheduleNavigation(l,ci,null,h,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}ow(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ci,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let a={replaceUrl:!0},c=s?.navigationId?s:null;if(s){let h=M({},s);delete h.navigationId,delete h.\u0275routerPageId,Object.keys(h).length!==0&&(a.state=h)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,c,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(tu),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:a,fragment:c,queryParamsHandling:l,preserveFragment:h}=i,p=h?this.currentUrlTree.fragment:c,m=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":m=M(M({},this.currentUrlTree.queryParams),a);break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=a||null}m!==null&&(m=this.removeEmptyProps(m));let _;try{let b=s?s.snapshot:this.routerState.snapshot.root;_=Kp(b)}catch{(typeof r[0]!="string"||r[0][0]!=="/")&&(r=[]),_=this.currentUrlTree.root}return Hp(_,r,m,p??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ln(r)?r:this.parseUrl(r),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,ci,null,i)}navigate(r,i={skipLocationChange:!1}){return sw(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=M({},rw):i===!1?s=M({},iw):s=i,ln(r))return Rp(this.currentUrlTree,r,s);let a=this.parseUrl(r);return Rp(this.currentUrlTree,a,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,a])=>(a!=null&&(i[s]=a),i),{})}scheduleNavigation(r,i,s,a,c){if(this.disposed)return Promise.resolve(!1);let l,h,p;c?(l=c.resolve,h=c.reject,p=c.promise):p=new Promise((_,b)=>{l=_,h=b});let m=this.pendingTasks.add();return fg(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(m))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:a,resolve:l,reject:h,promise:p,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),p.catch(_=>Promise.reject(_))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function sw(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new le(4008,!1)}function ow(n){return!(n instanceof di)&&!(n instanceof Wn)}var _R=(()=>{let e=class e{constructor(r,i,s,a,c,l){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=a,this.el=c,this.locationStrategy=l,this.href=null,this.onChanges=new Vt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let h=c.nativeElement.tagName?.toLowerCase();this.isAnchorElement=h==="a"||h==="area",this.isAnchorElement?this.subscription=r.events.subscribe(p=>{p instanceof ot&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(ln(r)?this.routerLinkInput=r:this.routerLinkInput=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0"))}onClick(r,i,s,a,c){let l=this.urlTree;if(l===null||this.isAnchorElement&&(r!==0||i||s||a||c||typeof this.target=="string"&&this.target!="_self"))return!0;let h={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,h),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:kf(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,a=this.el.nativeElement;i!==null?s.setAttribute(a,r,i):s.removeAttribute(a,r)}get urlTree(){return this.routerLinkInput===null?null:ln(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Vn(At),Vn(qt),wf("tabindex"),Vn(Mf),Vn(Ef),Vn(Qr))},e.\u0275dir=Xa({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&qf("click",function(c){return s.onClick(c.button,c.ctrlKey,c.shiftKey,c.altKey,c.metaKey)}),i&2&&Bf("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Ns],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Ns],replaceUrl:[2,"replaceUrl","replaceUrl",Ns],routerLink:"routerLink"},standalone:!0,features:[Ff,Za]});let n=e;return n})();var Xs=class{};var aw=(()=>{let e=class e{constructor(r,i,s,a,c){this.router=r,this.injector=s,this.preloadingStrategy=a,this.loader=c}setUpPreloading(){this.subscription=this.router.events.pipe(it(r=>r instanceof ot),Ut(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let a of i){a.providers&&!a._injector&&(a._injector=oc(a.providers,r,`Route: ${a.path}`));let c=a._injector??r,l=a._loadedInjector??c;(a.loadChildren&&!a._loadedRoutes&&a.canLoad===void 0||a.loadComponent&&!a._loadedComponent)&&s.push(this.preloadConfig(c,a)),(a.children||a._loadedRoutes)&&s.push(this.processRoutes(l,a.children??a._loadedRoutes))}return xe(s).pipe(Ga())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let a=s.pipe(je(c=>c===null?U(void 0):(i._loadedRoutes=c.routes,i._loadedInjector=c.injector,this.processRoutes(c.injector??r,c.routes))));if(i.loadComponent&&!i._loadedComponent){let c=this.loader.loadComponent(i);return xe([a,c]).pipe(Ga())}else return a})}};e.\u0275fac=function(i){return new(i||e)(J(At),J(Ds),J(xn),J(Xs),J(nu))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pg=new ce(""),cw=(()=>{let e=class e{constructor(r,i,s,a,c={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=a,this.options=c,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},c.scrollPositionRestoration||="disabled",c.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Gn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ot?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof $t&&r.code===qs.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Gs&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Gs(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Of()},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();function IR(n,...e){return It([{provide:yi,multi:!0,useValue:n},[],{provide:qt,useFactory:gg,deps:[At]},{provide:Kr,multi:!0,useFactory:mg},e.map(t=>t.\u0275providers)])}function gg(n){return n.routerState.root}function Ai(n,e){return{\u0275kind:n,\u0275providers:e}}function mg(){let n=V(sn);return e=>{let t=n.get(Hr);if(e!==t.components[0])return;let r=n.get(At),i=n.get(yg);n.get(su)===1&&r.initialNavigation(),n.get(vg,null,Ya.Optional)?.setUpPreloading(),n.get(pg,null,Ya.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var yg=new ce("",{factory:()=>new Vt}),su=new ce("",{providedIn:"root",factory:()=>1});function uw(){return Ai(2,[{provide:su,useValue:0},{provide:ac,multi:!0,deps:[sn],useFactory:e=>{let t=e.get(ep,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(At),s=e.get(yg);fg(i,()=>{r(!0)}),e.get(iu).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function lw(){return Ai(3,[{provide:ac,multi:!0,useFactory:()=>{let e=V(At);return()=>{e.setUpLocationChangeListener()}}},{provide:su,useValue:2}])}var vg=new ce("");function hw(n){return Ai(0,[{provide:vg,useExisting:aw},{provide:Xs,useExisting:n}])}function dw(){return Ai(8,[Np,{provide:Zs,useExisting:Np}])}function fw(n){let e=[{provide:lg,useValue:QI},{provide:hg,useValue:M({skipNextTransition:!!n?.skipInitialTransition},n)}];return Ai(9,e)}var Mp=new ce("ROUTER_FORROOT_GUARD"),pw=[Jr,{provide:_i,useClass:zn},At,wi,{provide:qt,useFactory:gg,deps:[At]},nu,[]],wR=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[pw,[],{provide:yi,multi:!0,useValue:r},{provide:Mp,useFactory:vw,deps:[[At,new et,new vf]]},{provide:Ti,useValue:i||{}},i?.useHash?mw():yw(),gw(),i?.preloadingStrategy?hw(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?_w(i):[],i?.bindToComponentInputs?dw().\u0275providers:[],i?.enableViewTransitions?fw().\u0275providers:[],Iw()]}}static forChild(r){return{ngModule:e,providers:[{provide:yi,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(J(Mp,8))},e.\u0275mod=Rs({type:e}),e.\u0275inj=Ss({});let n=e;return n})();function gw(){return{provide:pg,useFactory:()=>{let n=V(ip),e=V(Me),t=V(Ti),r=V(iu),i=V(_i);return t.scrollOffset&&n.setOffset(t.scrollOffset),new cw(i,r,n,e,t)}}}function mw(){return{provide:Qr,useClass:np}}function yw(){return{provide:Qr,useClass:tp}}function vw(n){return"guarded"}function _w(n){return[n.initialNavigation==="disabled"?lw().\u0275providers:[],n.initialNavigation==="enabledBlocking"?uw().\u0275providers:[]]}var Lp=new ce("");function Iw(){return[{provide:Lp,useFactory:mg},{provide:Kr,multi:!0,useExisting:Lp}]}var Ig=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ww=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],c=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},wg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,c=a?n[i+1]:0,l=i+2<n.length,h=l?n[i+2]:0,p=s>>2,m=(s&3)<<4|c>>4,_=(c&15)<<2|h>>6,b=h&63;l||(b=64,a||(_=64)),r.push(t[p],t[m],t[_],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ig(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ww(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new au;let _=s<<2|c>>4;if(r.push(_),h!==64){let b=c<<4&240|h>>2;if(r.push(b),m!==64){let C=h<<6&192|m;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},au=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Ew=function(n){let e=Ig(n);return wg.encodeByteArray(e,!0)},bi=function(n){return Ew(n).replace(/\./g,"")},uu=function(n){try{return wg.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Tw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Aw=()=>Tw().__FIREBASE_DEFAULTS__,bw=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Sw=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&uu(n[1]);return e&&JSON.parse(e)},no=()=>{try{return Aw()||bw()||Sw()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Eg=n=>{var e,t;return(t=(e=no())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Tg=n=>{let e=Eg(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},lu=()=>{var n;return(n=no())===null||n===void 0?void 0:n.config},Ag=n=>{var e;return(e=no())===null||e===void 0?void 0:e[`_${n}`]};var to=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function bg(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[bi(JSON.stringify(t)),bi(JSON.stringify(a)),""].join(".")}function qe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qe())}function Rw(){var n;let e=(n=no())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Rg(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Cg(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Pg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Dg(){return!Rw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hu(){try{return typeof indexedDB=="object"}catch{return!1}}function Ng(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var Cw="FirebaseError",Qe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Cw,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bt.prototype.create)}},bt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Pw(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Qe(i,c,r)}};function Pw(n,e){return n.replace(Dw,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Dw=/\{\$([^}]+)}/g;function Qn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(_g(s)&&_g(a)){if(!Qn(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function _g(n){return n!==null&&typeof n=="object"}function du(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function kg(n,e){let t=new cu(n,e);return t.subscribe.bind(t)}var cu=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Nw(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=ou),i.error===void 0&&(i.error=ou),i.complete===void 0&&(i.complete=ou);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Nw(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ou(){}var AR=4*60*60*1e3;function Le(n){return n&&n._delegate?n._delegate:n}var Je=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var hn="[DEFAULT]";var fu=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new to;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ow(e))try{this.getOrInitializeService({instanceIdentifier:hn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=hn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return R(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=hn){return this.instances.has(e)}getOptions(e=hn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:kw(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=hn){return this.component?this.component.multipleInstances?e:hn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function kw(n){return n===hn?void 0:n}function Ow(n){return n.instantiationMode==="EAGER"}var ro=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new fu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var xw=[],K=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(K||{}),Mw={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},Lw=K.INFO,Vw={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},Fw=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Vw[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Gt=class{constructor(e){this.name=e,this._logLevel=Lw,this._logHandler=Fw,this._userLogHandler=null,xw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in K))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Mw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...e),this._logHandler(this,K.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...e),this._logHandler(this,K.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,K.INFO,...e),this._logHandler(this,K.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,K.WARN,...e),this._logHandler(this,K.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...e),this._logHandler(this,K.ERROR,...e)}};var Uw=(n,e)=>e.some(t=>n instanceof t),Og,xg;function jw(){return Og||(Og=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bw(){return xg||(xg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Mg=new WeakMap,gu=new WeakMap,Lg=new WeakMap,pu=new WeakMap,yu=new WeakMap;function $w(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(at(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Mg.set(t,n)}).catch(()=>{}),yu.set(e,n),e}function qw(n){if(gu.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});gu.set(n,e)}var mu={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return gu.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Lg.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return at(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Vg(n){mu=n(mu)}function zw(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(io(this),e,...t);return Lg.set(r,e.sort?e.sort():[e]),at(r)}:Bw().includes(n)?function(...e){return n.apply(io(this),e),at(Mg.get(this))}:function(...e){return at(n.apply(io(this),e))}}function Gw(n){return typeof n=="function"?zw(n):(n instanceof IDBTransaction&&qw(n),Uw(n,jw())?new Proxy(n,mu):n)}function at(n){if(n instanceof IDBRequest)return $w(n);if(pu.has(n))return pu.get(n);let e=Gw(n);return e!==n&&(pu.set(n,e),yu.set(e,n)),e}var io=n=>yu.get(n);function Ug(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),c=at(a);return r&&a.addEventListener("upgradeneeded",l=>{r(at(a.result),l.oldVersion,l.newVersion,at(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var Ww=["get","getKey","getAll","getAllKeys","count"],Kw=["put","add","delete","clear"],vu=new Map;function Fg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(vu.get(e))return vu.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Kw.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Ww.includes(t)))return;let s=function(a,...c){return R(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),h=l.store;return r&&(h=h.index(c.shift())),(yield Promise.all([h[t](...c),i&&l.done]))[0]})};return vu.set(e,s),s}Vg(n=>Te(M({},n),{get:(e,t,r)=>Fg(e,t)||n.get(e,t,r),has:(e,t)=>!!Fg(e,t)||n.has(e,t)}));var Iu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Hw(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Hw(n){let e=n.getComponent();return e?.type==="VERSION"}var wu="@firebase/app",jg="0.10.11";var St=new Gt("@firebase/app"),Qw="@firebase/app-compat",Jw="@firebase/analytics-compat",Yw="@firebase/analytics",Xw="@firebase/app-check-compat",Zw="@firebase/app-check",eE="@firebase/auth",tE="@firebase/auth-compat",nE="@firebase/database",rE="@firebase/database-compat",iE="@firebase/functions",sE="@firebase/functions-compat",oE="@firebase/installations",aE="@firebase/installations-compat",cE="@firebase/messaging",uE="@firebase/messaging-compat",lE="@firebase/performance",hE="@firebase/performance-compat",dE="@firebase/remote-config",fE="@firebase/remote-config-compat",pE="@firebase/storage",gE="@firebase/storage-compat",mE="@firebase/firestore",yE="@firebase/vertexai-preview",vE="@firebase/firestore-compat",_E="firebase",IE="10.13.2";var Eu="[DEFAULT]",wE={[wu]:"fire-core",[Qw]:"fire-core-compat",[Yw]:"fire-analytics",[Jw]:"fire-analytics-compat",[Zw]:"fire-app-check",[Xw]:"fire-app-check-compat",[eE]:"fire-auth",[tE]:"fire-auth-compat",[nE]:"fire-rtdb",[rE]:"fire-rtdb-compat",[iE]:"fire-fn",[sE]:"fire-fn-compat",[oE]:"fire-iid",[aE]:"fire-iid-compat",[cE]:"fire-fcm",[uE]:"fire-fcm-compat",[lE]:"fire-perf",[hE]:"fire-perf-compat",[dE]:"fire-rc",[fE]:"fire-rc-compat",[pE]:"fire-gcs",[gE]:"fire-gcs-compat",[mE]:"fire-fst",[vE]:"fire-fst-compat",[yE]:"fire-vertex","fire-js":"fire-js",[_E]:"fire-js-all"};var Si=new Map,EE=new Map,Tu=new Map;function Bg(n,e){try{n.container.addComponent(e)}catch(t){St.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Kt(n){let e=n.name;if(Tu.has(e))return St.debug(`There were multiple attempts to register component ${e}.`),!1;Tu.set(e,n);for(let t of Si.values())Bg(t,n);for(let t of EE.values())Bg(t,n);return!0}function Ru(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Jn(n){return n.settings!==void 0}var TE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wt=new bt("app","Firebase",TE);var Au=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Je("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wt.create("app-deleted",{appName:this._name})}};var Yn=IE;function Cu(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Eu,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Wt.create("bad-app-name",{appName:String(i)});if(t||(t=lu()),!t)throw Wt.create("no-options");let s=Si.get(i);if(s){if(Qn(t,s.options)&&Qn(r,s.config))return s;throw Wt.create("duplicate-app",{appName:i})}let a=new ro(i);for(let l of Tu.values())a.addComponent(l);let c=new Au(t,r,a);return Si.set(i,c),c}function Ci(n=Eu){let e=Si.get(n);if(!e&&n===Eu&&lu())return Cu();if(!e)throw Wt.create("no-app",{appName:n});return e}function so(){return Array.from(Si.values())}function _e(n,e,t){var r;let i=(r=wE[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),St.warn(c.join(" "));return}Kt(new Je(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var AE="firebase-heartbeat-database",bE=1,Ri="firebase-heartbeat-store",_u=null;function Gg(){return _u||(_u=Ug(AE,bE,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ri)}catch(t){console.warn(t)}}}}).catch(n=>{throw Wt.create("idb-open",{originalErrorMessage:n.message})})),_u}function SE(n){return R(this,null,function*(){try{let t=(yield Gg()).transaction(Ri),r=yield t.objectStore(Ri).get(Wg(n));return yield t.done,r}catch(e){if(e instanceof Qe)St.warn(e.message);else{let t=Wt.create("idb-get",{originalErrorMessage:e?.message});St.warn(t.message)}}})}function $g(n,e){return R(this,null,function*(){try{let r=(yield Gg()).transaction(Ri,"readwrite");yield r.objectStore(Ri).put(e,Wg(n)),yield r.done}catch(t){if(t instanceof Qe)St.warn(t.message);else{let r=Wt.create("idb-set",{originalErrorMessage:t?.message});St.warn(r.message)}}})}function Wg(n){return`${n.name}!${n.options.appId}`}var RE=1024,CE=30*24*60*60*1e3,bu=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Su(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return R(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=qg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=CE}),this._storage.overwrite(this._heartbeatsCache))}catch(r){St.warn(r)}})}getHeartbeatsHeader(){return R(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=qg(),{heartbeatsToSend:r,unsentEntries:i}=PE(this._heartbeatsCache.heartbeats),s=bi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return St.warn(t),""}})}};function qg(){return new Date().toISOString().substring(0,10)}function PE(n,e=RE){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),zg(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),zg(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Su=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return R(this,null,function*(){return hu()?Ng().then(()=>!0).catch(()=>!1):!1})}read(){return R(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield SE(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return R(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return $g(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return R(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return $g(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function zg(n){return bi(JSON.stringify({version:2,heartbeats:n})).length}function DE(n){Kt(new Je("platform-logger",e=>new Iu(e),"PRIVATE")),Kt(new Je("heartbeat",e=>new bu(e),"PRIVATE")),_e(wu,jg,n),_e(wu,jg,"esm2017"),_e("fire-js","")}DE("");var NE="firebase",kE="10.13.2";_e(NE,kE,"app");var Zn=new Cs("ANGULARFIRE2_VERSION");function Du(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Di=(n,e)=>{let t=e?[e]:so(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Pi=class{constructor(){return Di(OE)}},OE="app-check";function Xn(){}var oo=class{zone;delegate;constructor(e,t=lf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},Pu=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Xn,{},Xn,Xn)),t.pipe(pe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ni=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new oo(Zone.current)),this.insideAngular=t.run(()=>new oo(Zone.current,uf)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(J(Me))};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ao(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function xE(n){return ao().ngZone.runOutsideAngular(()=>n())}function dn(n){return ao().ngZone.run(()=>n())}function ME(n){return LE(ao())(n)}function LE(n){return function(t){return t=t.lift(new Pu(n.ngZone)),t.pipe(za(n.outsideAngular),qa(n.insideAngular))}}var VE=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),dn(()=>n.apply(void 0,r))},Ye=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=dn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Xn,{},Xn,Xn))),r[s]=VE(r[s],t));let i=xE(()=>n.apply(this,r));if(!e)if(i instanceof Nn){let s=ao();return i.pipe(za(s.outsideAngular),qa(s.insideAngular))}else return dn(()=>i);return i instanceof Nn?i.pipe(ME):i instanceof Promise?dn(()=>new Promise((s,a)=>i.then(c=>dn(()=>s(c)),c=>dn(()=>a(c))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:dn(()=>i)};var fn=class{constructor(e){return e}},ki=class{constructor(){return so()}};function FE(n){return n&&n.length===1?n[0]:new fn(Ci())}var Nu=new ce("angularfire2._apps"),UE={provide:fn,useFactory:FE,deps:[[new et,Nu]]},jE={provide:ki,deps:[[new et,Nu]]};function BE(n){return(e,t)=>{let r=t.get(wt);_e("angularfire",Zn.full,"core"),_e("angularfire",Zn.full,"app"),_e("angular",Gf.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new fn(i)}}function l0(n,...e){return It([UE,jE,{provide:Nu,useFactory:BE(n),multi:!0,deps:[Me,sn,Ni,...e]}])}var h0=Ye(Cu,!0);function em(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var tm=em,nm=new bt("auth","Firebase",em());var ho=new Gt("@firebase/auth");function qE(n,...e){ho.logLevel<=K.WARN&&ho.warn(`Auth (${Yn}): ${n}`,...e)}function uo(n,...e){ho.logLevel<=K.ERROR&&ho.error(`Auth (${Yn}): ${n}`,...e)}function Kg(n,...e){throw qu(n,...e)}function $u(n,...e){return qu(n,...e)}function rm(n,e,t){let r=Object.assign(Object.assign({},tm()),{[e]:t});return new bt("auth","Firebase",r).create(e,{appName:n.name})}function lo(n){return rm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qu(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return nm.create(n,...e)}function te(n,e,...t){if(!n)throw qu(e,...t)}function Oi(n){let e="INTERNAL ASSERTION FAILED: "+n;throw uo(e),new Error(e)}function fo(n,e){n||Oi(e)}function zE(){return Hg()==="http:"||Hg()==="https:"}function Hg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function GE(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zE()||Cg()||"connection"in navigator)?navigator.onLine:!0}function WE(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var gn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,fo(t>e,"Short delay should be less than long delay!"),this.isMobile=Sg()||Pg()}get(){return GE()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function KE(n,e){fo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var po=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var HE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var QE=new gn(3e4,6e4);function im(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function vo(s,a,c,l){return R(this,arguments,function*(n,e,t,r,i={}){return sm(n,i,()=>R(this,null,function*(){let h={},p={};r&&(e==="GET"?p=r:h={body:JSON.stringify(r)});let m=du(Object.assign({key:n.config.apiKey},p)).slice(1),_=yield n._getAdditionalHeaders();_["Content-Type"]="application/json",n.languageCode&&(_["X-Firebase-Locale"]=n.languageCode);let b=Object.assign({method:e,headers:_},h);return Rg()||(b.referrerPolicy="no-referrer"),po.fetch()(om(n,n.config.apiHost,t,m),b)}))})}function sm(n,e,t){return R(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},HE),e);try{let i=new xu(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw co(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw co(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw co(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw co(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw rm(n,p,h);Kg(n,p)}}catch(i){if(i instanceof Qe)throw i;Kg(n,"network-request-failed",{message:String(i)})}})}function om(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?KE(n.config,i):`${n.config.apiScheme}://${i}`}var xu=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($u(this.auth,"network-request-failed")),QE.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function co(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=$u(n,e,r);return i.customData._tokenResponse=t,i}function JE(n,e){return R(this,null,function*(){return vo(n,"POST","/v1/accounts:delete",e)})}function am(n,e){return R(this,null,function*(){return vo(n,"POST","/v1/accounts:lookup",e)})}function xi(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function zu(n,e=!1){return R(this,null,function*(){let t=Le(n),r=yield t.getIdToken(e),i=cm(r);te(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:xi(ku(i.auth_time)),issuedAtTime:xi(ku(i.iat)),expirationTime:xi(ku(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function ku(n){return Number(n)*1e3}function cm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return uo("JWT malformed, contained fewer than 3 sections"),null;try{let i=uu(t);return i?JSON.parse(i):(uo("Failed to decode base64 JWT payload"),null)}catch(i){return uo("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qg(n){let e=cm(n);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Mu(n,e,t=!1){return R(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Qe&&YE(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function YE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Lu=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>R(this,null,function*(){yield this.iteration()}),t)}iteration(){return R(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Li=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xi(this.lastLoginAt),this.creationTime=xi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function go(n){return R(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Mu(n,am(t,{idToken:r}));te(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?um(s.providerUserInfo):[],c=XE(n.providerData,a),l=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!c?.length,p=l?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Li(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)})}function Gu(n){return R(this,null,function*(){let e=Le(n);yield go(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function XE(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function um(n){return n.map(e=>{var{providerId:t}=e,r=$a(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function ZE(n,e){return R(this,null,function*(){let t=yield sm(n,{},()=>R(this,null,function*(){let r=du({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=om(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",po.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function eT(n,e){return R(this,null,function*(){return vo(n,"POST","/v2/accounts:revokeToken",im(n,e))})}var Mi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){te(e.length!==0,"internal-error");let t=Qg(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return R(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return R(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield ZE(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(te(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(te(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(te(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Oi("not implemented")}};function Ht(n,e){te(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Vi=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=$a(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Lu(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Li(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return R(this,null,function*(){let t=yield Mu(this,this.stsTokenManager.getToken(this.auth,e));return te(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return zu(this,e)}reload(){return Gu(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return R(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield go(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return R(this,null,function*(){if(Jn(this.auth.app))return Promise.reject(lo(this.auth));let e=yield this.getIdToken();return yield Mu(this,JE(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,l,h,p;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,_=(i=t.email)!==null&&i!==void 0?i:void 0,b=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,C=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(c=t.tenantId)!==null&&c!==void 0?c:void 0,D=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,B=(h=t.createdAt)!==null&&h!==void 0?h:void 0,z=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:G,emailVerified:re,isAnonymous:we,providerData:ie,stsTokenManager:w}=t;te(G&&w,e,"internal-error");let g=Mi.fromJSON(this.name,w);te(typeof G=="string",e,"internal-error"),Ht(m,e.name),Ht(_,e.name),te(typeof re=="boolean",e,"internal-error"),te(typeof we=="boolean",e,"internal-error"),Ht(b,e.name),Ht(C,e.name),Ht(O,e.name),Ht(D,e.name),Ht(B,e.name),Ht(z,e.name);let v=new n({uid:G,auth:e,email:_,emailVerified:re,displayName:m,isAnonymous:we,photoURL:C,phoneNumber:b,tenantId:O,stsTokenManager:g,createdAt:B,lastLoginAt:z});return ie&&Array.isArray(ie)&&(v.providerData=ie.map(I=>Object.assign({},I))),D&&(v._redirectEventId=D),v}static _fromIdTokenResponse(e,t,r=!1){return R(this,null,function*(){let i=new Mi;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield go(s),s})}static _fromGetAccountInfoResponse(e,t,r){return R(this,null,function*(){let i=t.users[0];te(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?um(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new Mi;c.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Li(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,h),l})}};var Jg=new Map;function pn(n){fo(n instanceof Function,"Expected a class definition");let e=Jg.get(n);return e?(fo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Jg.set(n,e),e)}var tT=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return R(this,null,function*(){return!0})}_set(t,r){return R(this,null,function*(){this.storage[t]=r})}_get(t){return R(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return R(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Vu=tT;function Ou(n,e,t){return`firebase:${n}:${e}:${t}`}var mo=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ou(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ou("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return R(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Vi._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return R(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return R(this,null,function*(){if(!t.length)return new n(pn(Vu),e,r);let i=(yield Promise.all(t.map(h=>R(this,null,function*(){if(yield h._isAvailable())return h})))).filter(h=>h),s=i[0]||pn(Vu),a=Ou(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let p=yield h._get(a);if(p){let m=Vi._fromJSON(e,p);h!==s&&(c=m),s=h;break}}catch{}let l=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(h=>R(this,null,function*(){if(h!==s)try{yield h._remove(a)}catch{}}))),new n(s,e,r))})}};function Yg(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(aT(e))return"Blackberry";if(cT(e))return"Webos";if(rT(e))return"Safari";if((e.includes("chrome/")||iT(e))&&!e.includes("edge/"))return"Chrome";if(oT(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function nT(n=qe()){return/firefox\//i.test(n)}function rT(n=qe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iT(n=qe()){return/crios\//i.test(n)}function sT(n=qe()){return/iemobile/i.test(n)}function oT(n=qe()){return/android/i.test(n)}function aT(n=qe()){return/blackberry/i.test(n)}function cT(n=qe()){return/webos/i.test(n)}function lm(n,e=[]){let t;switch(n){case"Browser":t=Yg(qe());break;case"Worker":t=`${Yg(qe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yn}/${r}`}var Fu=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,c)=>{try{let l=e(s);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return R(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function uT(t){return R(this,arguments,function*(n,e={}){return vo(n,"GET","/v2/passwordPolicy",im(n,e))})}var lT=6,Uu=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:lT,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var ju=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yo(this),this.idTokenSubscription=new yo(this),this.beforeStateQueue=new Fu(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pn(t)),this._initializationPromise=this.queue(()=>R(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield mo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return R(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return R(this,null,function*(){try{let t=yield am(this,{idToken:e}),r=yield Vi._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return R(this,null,function*(){var t;if(Jn(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return R(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return R(this,null,function*(){try{yield go(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=WE()}_delete(){return R(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return R(this,null,function*(){if(Jn(this.app))return Promise.reject(lo(this));let t=e?Le(e):null;return t&&te(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return R(this,null,function*(){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>R(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return R(this,null,function*(){return Jn(this.app)?Promise.reject(lo(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Jn(this.app)?Promise.reject(lo(this)):this.queue(()=>R(this,null,function*(){yield this.assertedPersistence.setPersistence(pn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return R(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return R(this,null,function*(){let e=yield uT(this),t=new Uu(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new bt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return R(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield eT(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return R(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return R(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&pn(e)||this._popupRedirectResolver;te(t,this,"argument-error"),this.redirectPersistenceManager=yield mo.create(this,[pn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return R(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>R(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return R(this,null,function*(){if(e===this.currentUser)return this.queue(()=>R(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return R(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return R(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return R(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&qE(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function hT(n){return Le(n)}var yo=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=kg(t=>this.observer=t)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var dT={loadJS(){return R(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fT(n){dT=n}function pT(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function gT(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(pn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var T0=pT("rcb"),A0=new gn(3e4,6e4);var b0=new gn(2e3,1e4);var S0=10*60*1e3;var R0=new gn(3e4,6e4);var C0=new gn(5e3,15e3);var P0=encodeURIComponent("fac");var Xg="@firebase/auth",Zg="1.7.9";var Bu=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return R(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function mT(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yT(n){Kt(new Je("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;te(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lm(n)},h=new ju(r,i,s,l);return gT(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Kt(new Je("auth-internal",e=>{let t=hT(e.getProvider("auth").getImmediate());return(r=>new Bu(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),_e(Xg,Zg,mT(n)),_e(Xg,Zg,"esm2017")}var vT=5*60,D0=Ag("authIdTokenMaxAge")||vT;function _T(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}fT({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=$u("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",_T().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yT("Browser");var vA="auth";var _o=class{constructor(){return Di(vA)}};var hm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dm={};var Qt,Wu;(function(){var n;function e(w,g){function v(){}v.prototype=g.prototype,w.D=g.prototype,w.prototype=new v,w.prototype.constructor=w,w.C=function(I,E,A){for(var y=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)y[yt-2]=arguments[yt];return g.prototype[E].apply(I,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,g,v){v||(v=0);var I=Array(16);if(typeof g=="string")for(var E=0;16>E;++E)I[E]=g.charCodeAt(v++)|g.charCodeAt(v++)<<8|g.charCodeAt(v++)<<16|g.charCodeAt(v++)<<24;else for(E=0;16>E;++E)I[E]=g[v++]|g[v++]<<8|g[v++]<<16|g[v++]<<24;g=w.g[0],v=w.g[1],E=w.g[2];var A=w.g[3],y=g+(A^v&(E^A))+I[0]+3614090360&4294967295;g=v+(y<<7&4294967295|y>>>25),y=A+(E^g&(v^E))+I[1]+3905402710&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(v^A&(g^v))+I[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(g^E&(A^g))+I[3]+3250441966&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(A^v&(E^A))+I[4]+4118548399&4294967295,g=v+(y<<7&4294967295|y>>>25),y=A+(E^g&(v^E))+I[5]+1200080426&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(v^A&(g^v))+I[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(g^E&(A^g))+I[7]+4249261313&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(A^v&(E^A))+I[8]+1770035416&4294967295,g=v+(y<<7&4294967295|y>>>25),y=A+(E^g&(v^E))+I[9]+2336552879&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(v^A&(g^v))+I[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(g^E&(A^g))+I[11]+2304563134&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(A^v&(E^A))+I[12]+1804603682&4294967295,g=v+(y<<7&4294967295|y>>>25),y=A+(E^g&(v^E))+I[13]+4254626195&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(v^A&(g^v))+I[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(g^E&(A^g))+I[15]+1236535329&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(E^A&(v^E))+I[1]+4129170786&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(g^v))+I[6]+3225465664&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(A^g))+I[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(E^A))+I[0]+3921069994&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(v^E))+I[5]+3593408605&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(g^v))+I[10]+38016083&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(A^g))+I[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(E^A))+I[4]+3889429448&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(v^E))+I[9]+568446438&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(g^v))+I[14]+3275163606&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(A^g))+I[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(E^A))+I[8]+1163531501&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(v^E))+I[13]+2850285829&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(g^v))+I[2]+4243563512&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(A^g))+I[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(E^A))+I[12]+2368359562&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(v^E^A)+I[5]+4294588738&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^E)+I[8]+2272392833&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^v)+I[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^g)+I[14]+4259657740&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(v^E^A)+I[1]+2763975236&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^E)+I[4]+1272893353&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^v)+I[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^g)+I[10]+3200236656&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(v^E^A)+I[13]+681279174&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^E)+I[0]+3936430074&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^v)+I[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^g)+I[6]+76029189&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(v^E^A)+I[9]+3654602809&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^E)+I[12]+3873151461&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^v)+I[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^g)+I[2]+3299628645&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(E^(v|~A))+I[0]+4096336452&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~E))+I[7]+1126891415&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~v))+I[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~g))+I[5]+4237533241&4294967295,v=E+(y<<21&4294967295|y>>>11),y=g+(E^(v|~A))+I[12]+1700485571&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~E))+I[3]+2399980690&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~v))+I[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~g))+I[1]+2240044497&4294967295,v=E+(y<<21&4294967295|y>>>11),y=g+(E^(v|~A))+I[8]+1873313359&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~E))+I[15]+4264355552&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~v))+I[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~g))+I[13]+1309151649&4294967295,v=E+(y<<21&4294967295|y>>>11),y=g+(E^(v|~A))+I[4]+4149444226&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~E))+I[11]+3174756917&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~v))+I[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~g))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var v=g-this.blockSize,I=this.B,E=this.h,A=0;A<g;){if(E==0)for(;A<=v;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<g;)if(I[E++]=w.charCodeAt(A++),E==this.blockSize){i(this,I),E=0;break}}else for(;A<g;)if(I[E++]=w[A++],E==this.blockSize){i(this,I),E=0;break}}this.h=E,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var v=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=v&255,v/=256;for(this.u(w),w=Array(16),g=v=0;4>g;++g)for(var I=0;32>I;I+=8)w[v++]=this.g[g]>>>I&255;return w};function s(w,g){var v=c;return Object.prototype.hasOwnProperty.call(v,w)?v[w]:v[w]=g(w)}function a(w,g){this.h=g;for(var v=[],I=!0,E=w.length-1;0<=E;E--){var A=w[E]|0;I&&A==g||(v[E]=A,I=!1)}this.g=v}var c={};function l(w){return-128<=w&&128>w?s(w,function(g){return new a([g|0],0>g?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return m;if(0>w)return D(h(-w));for(var g=[],v=1,I=0;w>=v;I++)g[I]=w/v|0,v*=4294967296;return new a(g,0)}function p(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return D(p(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(g,8)),I=m,E=0;E<w.length;E+=8){var A=Math.min(8,w.length-E),y=parseInt(w.substring(E,E+A),g);8>A?(A=h(Math.pow(g,A)),I=I.j(A).add(h(y))):(I=I.j(v),I=I.add(h(y)))}return I}var m=l(0),_=l(1),b=l(16777216);n=a.prototype,n.m=function(){if(O(this))return-D(this).m();for(var w=0,g=1,v=0;v<this.g.length;v++){var I=this.i(v);w+=(0<=I?I:4294967296+I)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(C(this))return"0";if(O(this))return"-"+D(this).toString(w);for(var g=h(Math.pow(w,6)),v=this,I="";;){var E=re(v,g).g;v=B(v,E.j(g));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(w);if(v=E,C(v))return A+I;for(;6>A.length;)A="0"+A;I=A+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function C(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function O(w){return w.h==-1}n.l=function(w){return w=B(this,w),O(w)?-1:C(w)?0:1};function D(w){for(var g=w.g.length,v=[],I=0;I<g;I++)v[I]=~w.g[I];return new a(v,~w.h).add(_)}n.abs=function(){return O(this)?D(this):this},n.add=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0,E=0;E<=g;E++){var A=I+(this.i(E)&65535)+(w.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);I=y>>>16,A&=65535,y&=65535,v[E]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function B(w,g){return w.add(D(g))}n.j=function(w){if(C(this)||C(w))return m;if(O(this))return O(w)?D(this).j(D(w)):D(D(this).j(w));if(O(w))return D(this.j(D(w)));if(0>this.l(b)&&0>w.l(b))return h(this.m()*w.m());for(var g=this.g.length+w.g.length,v=[],I=0;I<2*g;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var E=0;E<w.g.length;E++){var A=this.i(I)>>>16,y=this.i(I)&65535,yt=w.i(E)>>>16,Tr=w.i(E)&65535;v[2*I+2*E]+=y*Tr,z(v,2*I+2*E),v[2*I+2*E+1]+=A*Tr,z(v,2*I+2*E+1),v[2*I+2*E+1]+=y*yt,z(v,2*I+2*E+1),v[2*I+2*E+2]+=A*yt,z(v,2*I+2*E+2)}for(I=0;I<g;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=g;I<2*g;I++)v[I]=0;return new a(v,0)};function z(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function G(w,g){this.g=w,this.h=g}function re(w,g){if(C(g))throw Error("division by zero");if(C(w))return new G(m,m);if(O(w))return g=re(D(w),g),new G(D(g.g),D(g.h));if(O(g))return g=re(w,D(g)),new G(D(g.g),g.h);if(30<w.g.length){if(O(w)||O(g))throw Error("slowDivide_ only works with positive integers.");for(var v=_,I=g;0>=I.l(w);)v=we(v),I=we(I);var E=ie(v,1),A=ie(I,1);for(I=ie(I,2),v=ie(v,2);!C(I);){var y=A.add(I);0>=y.l(w)&&(E=E.add(v),A=y),I=ie(I,1),v=ie(v,1)}return g=B(w,E.j(g)),new G(E,g)}for(E=m;0<=w.l(g);){for(v=Math.max(1,Math.floor(w.m()/g.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),A=h(v),y=A.j(g);O(y)||0<y.l(w);)v-=I,A=h(v),y=A.j(g);C(A)&&(A=_),E=E.add(A),w=B(w,y)}return new G(E,w)}n.A=function(w){return re(this,w).h},n.and=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0;I<g;I++)v[I]=this.i(I)&w.i(I);return new a(v,this.h&w.h)},n.or=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0;I<g;I++)v[I]=this.i(I)|w.i(I);return new a(v,this.h|w.h)},n.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0;I<g;I++)v[I]=this.i(I)^w.i(I);return new a(v,this.h^w.h)};function we(w){for(var g=w.g.length+1,v=[],I=0;I<g;I++)v[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(v,w.h)}function ie(w,g){var v=g>>5;g%=32;for(var I=w.g.length-v,E=[],A=0;A<I;A++)E[A]=0<g?w.i(A+v)>>>g|w.i(A+v+1)<<32-g:w.i(A+v);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Wu=dm.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,Qt=dm.Integer=a}).apply(typeof hm<"u"?hm:typeof self<"u"?self:typeof window<"u"?window:{});var Io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rt={};var Ku,Hu,er,Qu,Fi,wo,Ju,Yu,Xu;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,d){return o==Array.prototype||o==Object.prototype||(o[u]=d.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Io=="object"&&Io];for(var u=0;u<o.length;++u){var d=o[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(o,u){if(u)e:{var d=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in d))break e;d=d[T]}o=o[o.length-1],f=d[o],u=u(f),u!=f&&u!=null&&e(d,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var d=0,f=!1,T={next:function(){if(!f&&d<o.length){var S=d++;return{value:u(S,o[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,d){return d})}});var a=a||{},c=this||self;function l(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function h(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,d){return o.call.apply(o.bind,arguments)}function m(o,u,d){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(u,T)}}return function(){return o.apply(u,arguments)}}function _(o,u,d){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,_.apply(null,arguments)}function b(o,u){var d=Array.prototype.slice.call(arguments,1);return function(){var f=d.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function C(o,u){function d(){}d.prototype=u.prototype,o.aa=u.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(f,T,S){for(var k=Array(arguments.length-2),se=2;se<arguments.length;se++)k[se-2]=arguments[se];return u.prototype[T].apply(f,k)}}function O(o){let u=o.length;if(0<u){let d=Array(u);for(let f=0;f<u;f++)d[f]=o[f];return d}return[]}function D(o,u){for(let d=1;d<arguments.length;d++){let f=arguments[d];if(l(f)){let T=o.length||0,S=f.length||0;o.length=T+S;for(let k=0;k<S;k++)o[T+k]=f[k]}else o.push(f)}}class B{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function z(o){return/^[\s\xa0]*$/.test(o)}function G(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function re(o){return re[" "](o),o}re[" "]=function(){};var we=G().indexOf("Gecko")!=-1&&!(G().toLowerCase().indexOf("webkit")!=-1&&G().indexOf("Edge")==-1)&&!(G().indexOf("Trident")!=-1||G().indexOf("MSIE")!=-1)&&G().indexOf("Edge")==-1;function ie(o,u,d){for(let f in o)u.call(d,o[f],f,o)}function w(o,u){for(let d in o)u.call(void 0,o[d],d,o)}function g(o){let u={};for(let d in o)u[d]=o[d];return u}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,u){let d,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(d in f)o[d]=f[d];for(let S=0;S<v.length;S++)d=v[S],Object.prototype.hasOwnProperty.call(f,d)&&(o[d]=f[d])}}function E(o){var u=1;o=o.split(":");let d=[];for(;0<u&&o.length;)d.push(o.shift()),u--;return o.length&&d.push(o.join(":")),d}function A(o){c.setTimeout(()=>{throw o},0)}function y(){var o=pa;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class yt{constructor(){this.h=this.g=null}add(u,d){let f=Tr.get();f.set(u,d),this.h?this.h.next=f:this.g=f,this.h=f}}var Tr=new B(()=>new sv,o=>o.reset());class sv{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Ar,br=!1,pa=new yt,sd=()=>{let o=c.Promise.resolve(void 0);Ar=()=>{o.then(ov)}};var ov=()=>{for(var o;o=y();){try{o.h.call(o.g)}catch(d){A(d)}var u=Tr;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}br=!1};function Ot(){this.s=this.s,this.C=this.C}Ot.prototype.s=!1,Ot.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ot.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function be(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}be.prototype.h=function(){this.defaultPrevented=!0};var av=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let d=()=>{};c.addEventListener("test",d,u),c.removeEventListener("test",d,u)}catch{}return o}();function Sr(o,u){if(be.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(we){e:{try{re(u.nodeName);var T=!0;break e}catch{}T=!1}T||(u=null)}}else d=="mouseover"?u=o.fromElement:d=="mouseout"&&(u=o.toElement);this.relatedTarget=u,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:cv[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Sr.aa.h.call(this)}}C(Sr,be);var cv={2:"touch",3:"pen",4:"mouse"};Sr.prototype.h=function(){Sr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Rr="closure_listenable_"+(1e6*Math.random()|0),uv=0;function lv(o,u,d,f,T){this.listener=o,this.proxy=null,this.src=u,this.type=d,this.capture=!!f,this.ha=T,this.key=++uv,this.da=this.fa=!1}function cs(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function us(o){this.src=o,this.g={},this.h=0}us.prototype.add=function(o,u,d,f,T){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var k=ma(o,u,f,T);return-1<k?(u=o[k],d||(u.fa=!1)):(u=new lv(u,this.src,S,!!f,T),u.fa=d,o.push(u)),u};function ga(o,u){var d=u.type;if(d in o.g){var f=o.g[d],T=Array.prototype.indexOf.call(f,u,void 0),S;(S=0<=T)&&Array.prototype.splice.call(f,T,1),S&&(cs(u),o.g[d].length==0&&(delete o.g[d],o.h--))}}function ma(o,u,d,f){for(var T=0;T<o.length;++T){var S=o[T];if(!S.da&&S.listener==u&&S.capture==!!d&&S.ha==f)return T}return-1}var ya="closure_lm_"+(1e6*Math.random()|0),va={};function od(o,u,d,f,T){if(f&&f.once)return cd(o,u,d,f,T);if(Array.isArray(u)){for(var S=0;S<u.length;S++)od(o,u[S],d,f,T);return null}return d=Ea(d),o&&o[Rr]?o.K(u,d,h(f)?!!f.capture:!!f,T):ad(o,u,d,!1,f,T)}function ad(o,u,d,f,T,S){if(!u)throw Error("Invalid event type");var k=h(T)?!!T.capture:!!T,se=Ia(o);if(se||(o[ya]=se=new us(o)),d=se.add(u,d,f,k,S),d.proxy)return d;if(f=hv(),d.proxy=f,f.src=o,f.listener=d,o.addEventListener)av||(T=k),T===void 0&&(T=!1),o.addEventListener(u.toString(),f,T);else if(o.attachEvent)o.attachEvent(ld(u.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return d}function hv(){function o(d){return u.call(o.src,o.listener,d)}let u=dv;return o}function cd(o,u,d,f,T){if(Array.isArray(u)){for(var S=0;S<u.length;S++)cd(o,u[S],d,f,T);return null}return d=Ea(d),o&&o[Rr]?o.L(u,d,h(f)?!!f.capture:!!f,T):ad(o,u,d,!0,f,T)}function ud(o,u,d,f,T){if(Array.isArray(u))for(var S=0;S<u.length;S++)ud(o,u[S],d,f,T);else f=h(f)?!!f.capture:!!f,d=Ea(d),o&&o[Rr]?(o=o.i,u=String(u).toString(),u in o.g&&(S=o.g[u],d=ma(S,d,f,T),-1<d&&(cs(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete o.g[u],o.h--)))):o&&(o=Ia(o))&&(u=o.g[u.toString()],o=-1,u&&(o=ma(u,d,f,T)),(d=-1<o?u[o]:null)&&_a(d))}function _a(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Rr])ga(u.i,o);else{var d=o.type,f=o.proxy;u.removeEventListener?u.removeEventListener(d,f,o.capture):u.detachEvent?u.detachEvent(ld(d),f):u.addListener&&u.removeListener&&u.removeListener(f),(d=Ia(u))?(ga(d,o),d.h==0&&(d.src=null,u[ya]=null)):cs(o)}}}function ld(o){return o in va?va[o]:va[o]="on"+o}function dv(o,u){if(o.da)o=!0;else{u=new Sr(u,this);var d=o.listener,f=o.ha||o.src;o.fa&&_a(o),o=d.call(f,u)}return o}function Ia(o){return o=o[ya],o instanceof us?o:null}var wa="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ea(o){return typeof o=="function"?o:(o[wa]||(o[wa]=function(u){return o.handleEvent(u)}),o[wa])}function Se(){Ot.call(this),this.i=new us(this),this.M=this,this.F=null}C(Se,Ot),Se.prototype[Rr]=!0,Se.prototype.removeEventListener=function(o,u,d,f){ud(this,o,u,d,f)};function ke(o,u){var d,f=o.F;if(f)for(d=[];f;f=f.F)d.push(f);if(o=o.M,f=u.type||u,typeof u=="string")u=new be(u,o);else if(u instanceof be)u.target=u.target||o;else{var T=u;u=new be(f,o),I(u,T)}if(T=!0,d)for(var S=d.length-1;0<=S;S--){var k=u.g=d[S];T=ls(k,f,!0,u)&&T}if(k=u.g=o,T=ls(k,f,!0,u)&&T,T=ls(k,f,!1,u)&&T,d)for(S=0;S<d.length;S++)k=u.g=d[S],T=ls(k,f,!1,u)&&T}Se.prototype.N=function(){if(Se.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var d=o.g[u],f=0;f<d.length;f++)cs(d[f]);delete o.g[u],o.h--}}this.F=null},Se.prototype.K=function(o,u,d,f){return this.i.add(String(o),u,!1,d,f)},Se.prototype.L=function(o,u,d,f){return this.i.add(String(o),u,!0,d,f)};function ls(o,u,d,f){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var T=!0,S=0;S<u.length;++S){var k=u[S];if(k&&!k.da&&k.capture==d){var se=k.listener,Ee=k.ha||k.src;k.fa&&ga(o.i,k),T=se.call(Ee,f)!==!1&&T}}return T&&!f.defaultPrevented}function hd(o,u,d){if(typeof o=="function")d&&(o=_(o,d));else if(o&&typeof o.handleEvent=="function")o=_(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function dd(o){o.g=hd(()=>{o.g=null,o.i&&(o.i=!1,dd(o))},o.l);let u=o.h;o.h=null,o.m.apply(null,u)}class fv extends Ot{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:dd(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cr(o){Ot.call(this),this.h=o,this.g={}}C(Cr,Ot);var fd=[];function pd(o){ie(o.g,function(u,d){this.g.hasOwnProperty(d)&&_a(u)},o),o.g={}}Cr.prototype.N=function(){Cr.aa.N.call(this),pd(this)},Cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ta=c.JSON.stringify,pv=c.JSON.parse,gv=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function Aa(){}Aa.prototype.h=null;function gd(o){return o.h||(o.h=o.i())}function md(){}var Pr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ba(){be.call(this,"d")}C(ba,be);function Sa(){be.call(this,"c")}C(Sa,be);var en={},yd=null;function hs(){return yd=yd||new Se}en.La="serverreachability";function vd(o){be.call(this,en.La,o)}C(vd,be);function Dr(o){let u=hs();ke(u,new vd(u))}en.STAT_EVENT="statevent";function _d(o,u){be.call(this,en.STAT_EVENT,o),this.stat=u}C(_d,be);function Oe(o){let u=hs();ke(u,new _d(u,o))}en.Ma="timingevent";function Id(o,u){be.call(this,en.Ma,o),this.size=u}C(Id,be);function Nr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function kr(){this.g=!0}kr.prototype.xa=function(){this.g=!1};function mv(o,u,d,f,T,S){o.info(function(){if(o.g)if(S)for(var k="",se=S.split("&"),Ee=0;Ee<se.length;Ee++){var X=se[Ee].split("=");if(1<X.length){var Re=X[0];X=X[1];var Ce=Re.split("_");k=2<=Ce.length&&Ce[1]=="type"?k+(Re+"="+X+"&"):k+(Re+"=redacted&")}}else k=null;else k=S;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+u+`
`+d+`
`+k})}function yv(o,u,d,f,T,S,k){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+u+`
`+d+`
`+S+" "+k})}function Rn(o,u,d,f){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+_v(o,d)+(f?" "+f:"")})}function vv(o,u){o.info(function(){return"TIMEOUT: "+u})}kr.prototype.info=function(){};function _v(o,u){if(!o.g)return u;if(!u)return null;try{var d=JSON.parse(u);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var f=d[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var S=T[0];if(S!="noop"&&S!="stop"&&S!="close")for(var k=1;k<T.length;k++)T[k]=""}}}}return Ta(d)}catch{return u}}var ds={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},wd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ra;function fs(){}C(fs,Aa),fs.prototype.g=function(){return new XMLHttpRequest},fs.prototype.i=function(){return{}},Ra=new fs;function xt(o,u,d,f){this.j=o,this.i=u,this.l=d,this.R=f||1,this.U=new Cr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ed}function Ed(){this.i=null,this.g="",this.h=!1}var Td={},Ca={};function Pa(o,u,d){o.L=1,o.v=ys(vt(u)),o.m=d,o.P=!0,Ad(o,null)}function Ad(o,u){o.F=Date.now(),ps(o),o.A=vt(o.v);var d=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Fd(d.i,"t",f),o.C=0,d=o.j.J,o.h=new Ed,o.g=nf(o.j,d?u:null,!o.m),0<o.O&&(o.M=new fv(_(o.Y,o,o.g),o.O)),u=o.U,d=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(fd[0]=T.toString()),T=fd);for(var S=0;S<T.length;S++){var k=od(d,T[S],f||u.handleEvent,!1,u.h||u);if(!k)break;u.g[k.key]=k}u=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),Dr(),mv(o.i,o.u,o.A,o.l,o.R,o.m)}xt.prototype.ca=function(o){o=o.target;let u=this.M;u&&_t(o)==3?u.j():this.Y(o)},xt.prototype.Y=function(o){try{if(o==this.g)e:{let Ce=_t(this.g);var u=this.g.Ba();let Dn=this.g.Z();if(!(3>Ce)&&(Ce!=3||this.g&&(this.h.h||this.g.oa()||Gd(this.g)))){this.J||Ce!=4||u==7||(u==8||0>=Dn?Dr(3):Dr(2)),Da(this);var d=this.g.Z();this.X=d;t:if(bd(this)){var f=Gd(this.g);o="";var T=f.length,S=_t(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tn(this),Or(this);var k="";break t}this.h.i=new c.TextDecoder}for(u=0;u<T;u++)this.h.h=!0,o+=this.h.i.decode(f[u],{stream:!(S&&u==T-1)});f.length=0,this.h.g+=o,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=d==200,yv(this.i,this.u,this.A,this.l,this.R,Ce,d),this.o){if(this.T&&!this.K){t:{if(this.g){var se,Ee=this.g;if((se=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(se)){var X=se;break t}}X=null}if(d=X)Rn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Na(this,d);else{this.o=!1,this.s=3,Oe(12),tn(this),Or(this);break e}}if(this.P){d=!0;let Ze;for(;!this.J&&this.C<k.length;)if(Ze=Iv(this,k),Ze==Ca){Ce==4&&(this.s=4,Oe(14),d=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ze==Td){this.s=4,Oe(15),Rn(this.i,this.l,k,"[Invalid Chunk]"),d=!1;break}else Rn(this.i,this.l,Ze,null),Na(this,Ze);if(bd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ce!=4||k.length!=0||this.h.h||(this.s=1,Oe(16),d=!1),this.o=this.o&&d,!d)Rn(this.i,this.l,k,"[Invalid Chunked Response]"),tn(this),Or(this);else if(0<k.length&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.ba&&!Re.M&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Va(Re),Re.M=!0,Oe(11))}}else Rn(this.i,this.l,k,null),Na(this,k);Ce==4&&tn(this),this.o&&!this.J&&(Ce==4?Xd(this.j,this):(this.o=!1,ps(this)))}else Vv(this.g),d==400&&0<k.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),tn(this),Or(this)}}}catch{}finally{}};function bd(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Iv(o,u){var d=o.C,f=u.indexOf(`
`,d);return f==-1?Ca:(d=Number(u.substring(d,f)),isNaN(d)?Td:(f+=1,f+d>u.length?Ca:(u=u.slice(f,f+d),o.C=f+d,u)))}xt.prototype.cancel=function(){this.J=!0,tn(this)};function ps(o){o.S=Date.now()+o.I,Sd(o,o.I)}function Sd(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Nr(_(o.ba,o),u)}function Da(o){o.B&&(c.clearTimeout(o.B),o.B=null)}xt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(vv(this.i,this.A),this.L!=2&&(Dr(),Oe(17)),tn(this),this.s=2,Or(this)):Sd(this,this.S-o)};function Or(o){o.j.G==0||o.J||Xd(o.j,o)}function tn(o){Da(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,pd(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function Na(o,u){try{var d=o.j;if(d.G!=0&&(d.g==o||ka(d.h,o))){if(!o.K&&ka(d.h,o)&&d.G==3){try{var f=d.Da.g.parse(u)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)Es(d),Is(d);else break e;La(d),Oe(18)}}else d.za=T[1],0<d.za-d.T&&37500>T[2]&&d.F&&d.v==0&&!d.C&&(d.C=Nr(_(d.Za,d),6e3));if(1>=Pd(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else rn(d,11)}else if((o.K||d.g==o)&&Es(d),!z(u))for(T=d.Da.g.parse(u),u=0;u<T.length;u++){let X=T[u];if(d.T=X[0],X=X[1],d.G==2)if(X[0]=="c"){d.K=X[1],d.ia=X[2];let Re=X[3];Re!=null&&(d.la=Re,d.j.info("VER="+d.la));let Ce=X[4];Ce!=null&&(d.Aa=Ce,d.j.info("SVER="+d.Aa));let Dn=X[5];Dn!=null&&typeof Dn=="number"&&0<Dn&&(f=1.5*Dn,d.L=f,d.j.info("backChannelRequestTimeoutMs_="+f)),f=d;let Ze=o.g;if(Ze){let As=Ze.g?Ze.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(As){var S=f.h;S.g||As.indexOf("spdy")==-1&&As.indexOf("quic")==-1&&As.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(Oa(S,S.h),S.h=null))}if(f.D){let Fa=Ze.g?Ze.g.getResponseHeader("X-HTTP-Session-Id"):null;Fa&&(f.ya=Fa,ae(f.I,f.D,Fa))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),f=d;var k=o;if(f.qa=tf(f,f.J?f.ia:null,f.W),k.K){Dd(f.h,k);var se=k,Ee=f.L;Ee&&(se.I=Ee),se.B&&(Da(se),ps(se)),f.g=k}else Jd(f);0<d.i.length&&ws(d)}else X[0]!="stop"&&X[0]!="close"||rn(d,7);else d.G==3&&(X[0]=="stop"||X[0]=="close"?X[0]=="stop"?rn(d,7):Ma(d):X[0]!="noop"&&d.l&&d.l.ta(X),d.v=0)}}Dr(4)}catch{}}var wv=class{constructor(o,u){this.g=o,this.map=u}};function Rd(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cd(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Pd(o){return o.h?1:o.g?o.g.size:0}function ka(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Oa(o,u){o.g?o.g.add(u):o.h=u}function Dd(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Rd.prototype.cancel=function(){if(this.i=Nd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Nd(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(let d of o.g.values())u=u.concat(d.D);return u}return O(o.i)}function Ev(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var u=[],d=o.length,f=0;f<d;f++)u.push(o[f]);return u}u=[],d=0;for(f in o)u[d++]=o[f];return u}function Tv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var u=[];o=o.length;for(var d=0;d<o;d++)u.push(d);return u}u=[],d=0;for(let f in o)u[d++]=f;return u}}}function kd(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var d=Tv(o),f=Ev(o),T=f.length,S=0;S<T;S++)u.call(void 0,f[S],d&&d[S],o)}var Od=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Av(o,u){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var f=o[d].indexOf("="),T=null;if(0<=f){var S=o[d].substring(0,f);T=o[d].substring(f+1)}else S=o[d];u(S,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function nn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof nn){this.h=o.h,gs(this,o.j),this.o=o.o,this.g=o.g,ms(this,o.s),this.l=o.l;var u=o.i,d=new Lr;d.i=u.i,u.g&&(d.g=new Map(u.g),d.h=u.h),xd(this,d),this.m=o.m}else o&&(u=String(o).match(Od))?(this.h=!1,gs(this,u[1]||"",!0),this.o=xr(u[2]||""),this.g=xr(u[3]||"",!0),ms(this,u[4]),this.l=xr(u[5]||"",!0),xd(this,u[6]||"",!0),this.m=xr(u[7]||"")):(this.h=!1,this.i=new Lr(null,this.h))}nn.prototype.toString=function(){var o=[],u=this.j;u&&o.push(Mr(u,Md,!0),":");var d=this.g;return(d||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Mr(u,Md,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(Mr(d,d.charAt(0)=="/"?Rv:Sv,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",Mr(d,Pv)),o.join("")};function vt(o){return new nn(o)}function gs(o,u,d){o.j=d?xr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function ms(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function xd(o,u,d){u instanceof Lr?(o.i=u,Dv(o.i,o.h)):(d||(u=Mr(u,Cv)),o.i=new Lr(u,o.h))}function ae(o,u,d){o.i.set(u,d)}function ys(o){return ae(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function xr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Mr(o,u,d){return typeof o=="string"?(o=encodeURI(o).replace(u,bv),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function bv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Md=/[#\/\?@]/g,Sv=/[#\?:]/g,Rv=/[#\?]/g,Cv=/[#\?@]/g,Pv=/#/g;function Lr(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Mt(o){o.g||(o.g=new Map,o.h=0,o.i&&Av(o.i,function(u,d){o.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}n=Lr.prototype,n.add=function(o,u){Mt(this),this.i=null,o=Cn(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(u),this.h+=1,this};function Ld(o,u){Mt(o),u=Cn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Vd(o,u){return Mt(o),u=Cn(o,u),o.g.has(u)}n.forEach=function(o,u){Mt(this),this.g.forEach(function(d,f){d.forEach(function(T){o.call(u,T,f,this)},this)},this)},n.na=function(){Mt(this);let o=Array.from(this.g.values()),u=Array.from(this.g.keys()),d=[];for(let f=0;f<u.length;f++){let T=o[f];for(let S=0;S<T.length;S++)d.push(u[f])}return d},n.V=function(o){Mt(this);let u=[];if(typeof o=="string")Vd(this,o)&&(u=u.concat(this.g.get(Cn(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)u=u.concat(o[d])}return u},n.set=function(o,u){return Mt(this),this.i=null,o=Cn(this,o),Vd(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function Fd(o,u,d){Ld(o,u),0<d.length&&(o.i=null,o.g.set(Cn(o,u),O(d)),o.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],u=Array.from(this.g.keys());for(var d=0;d<u.length;d++){var f=u[d];let S=encodeURIComponent(String(f)),k=this.V(f);for(f=0;f<k.length;f++){var T=S;k[f]!==""&&(T+="="+encodeURIComponent(String(k[f]))),o.push(T)}}return this.i=o.join("&")};function Cn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Dv(o,u){u&&!o.j&&(Mt(o),o.i=null,o.g.forEach(function(d,f){var T=f.toLowerCase();f!=T&&(Ld(this,f),Fd(this,T,d))},o)),o.j=u}function Nv(o,u){let d=new kr;if(c.Image){let f=new Image;f.onload=b(Lt,d,"TestLoadImage: loaded",!0,u,f),f.onerror=b(Lt,d,"TestLoadImage: error",!1,u,f),f.onabort=b(Lt,d,"TestLoadImage: abort",!1,u,f),f.ontimeout=b(Lt,d,"TestLoadImage: timeout",!1,u,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else u(!1)}function kv(o,u){let d=new kr,f=new AbortController,T=setTimeout(()=>{f.abort(),Lt(d,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:f.signal}).then(S=>{clearTimeout(T),S.ok?Lt(d,"TestPingServer: ok",!0,u):Lt(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(T),Lt(d,"TestPingServer: error",!1,u)})}function Lt(o,u,d,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(d)}catch{}}function Ov(){this.g=new gv}function xv(o,u,d){let f=d||"";try{kd(o,function(T,S){let k=T;h(T)&&(k=Ta(T)),u.push(f+S+"="+encodeURIComponent(k))})}catch(T){throw u.push(f+"type="+encodeURIComponent("_badmap")),T}}function Vr(o){this.l=o.Ub||null,this.j=o.eb||!1}C(Vr,Aa),Vr.prototype.g=function(){return new vs(this.l,this.j)},Vr.prototype.i=function(o){return function(){return o}}({});function vs(o,u){Se.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(vs,Se),n=vs.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,Ur(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fr(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ur(this)),this.g&&(this.readyState=3,Ur(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ud(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ud(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?Fr(this):Ur(this),this.readyState==3&&Ud(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Fr(this))},n.Qa=function(o){this.g&&(this.response=o,Fr(this))},n.ga=function(){this.g&&Fr(this)};function Fr(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ur(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=u.next();return o.join(`\r
`)};function Ur(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(vs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function jd(o){let u="";return ie(o,function(d,f){u+=f,u+=":",u+=d,u+=`\r
`}),u}function xa(o,u,d){e:{for(f in d){var f=!1;break e}f=!0}f||(d=jd(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):ae(o,u,d))}function he(o){Se.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(he,Se);var Mv=/^https?$/i,Lv=["POST","PUT"];n=he.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,d,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ra.g(),this.v=this.o?gd(this.o):gd(Ra),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(S){Bd(this,S);return}if(o=d||"",d=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)d.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())d.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),T=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Lv,u,void 0))||f||T||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,k]of d)this.g.setRequestHeader(S,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zd(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){Bd(this,S)}};function Bd(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,$d(o),_s(o)}function $d(o){o.A||(o.A=!0,ke(o,"complete"),ke(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,ke(this,"complete"),ke(this,"abort"),_s(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_s(this,!0)),he.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?qd(this):this.bb())},n.bb=function(){qd(this)};function qd(o){if(o.h&&typeof a<"u"&&(!o.v[1]||_t(o)!=4||o.Z()!=2)){if(o.u&&_t(o)==4)hd(o.Ea,0,o);else if(ke(o,"readystatechange"),_t(o)==4){o.h=!1;try{let k=o.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var f;if(f=k===0){var T=String(o.D).match(Od)[1]||null;!T&&c.self&&c.self.location&&(T=c.self.location.protocol.slice(0,-1)),f=!Mv.test(T?T.toLowerCase():"")}d=f}if(d)ke(o,"complete"),ke(o,"success");else{o.m=6;try{var S=2<_t(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",$d(o)}}finally{_s(o)}}}}function _s(o,u){if(o.g){zd(o);let d=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||ke(o,"ready");try{d.onreadystatechange=f}catch{}}}function zd(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function _t(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<_t(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),pv(u)}};function Gd(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Vv(o){let u={};o=(o.g&&2<=_t(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(z(o[f]))continue;var d=E(o[f]);let T=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=u[T]||[];u[T]=S,S.push(d)}w(u,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function jr(o,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||u}function Wd(o){this.Aa=0,this.i=[],this.j=new kr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=jr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=jr("baseRetryDelayMs",5e3,o),this.cb=jr("retryDelaySeedMs",1e4,o),this.Wa=jr("forwardChannelMaxRetries",2,o),this.wa=jr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Rd(o&&o.concurrentRequestLimit),this.Da=new Ov,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Wd.prototype,n.la=8,n.G=1,n.connect=function(o,u,d,f){Oe(0),this.W=o,this.H=u||{},d&&f!==void 0&&(this.H.OSID=d,this.H.OAID=f),this.F=this.X,this.I=tf(this,null,this.W),ws(this)};function Ma(o){if(Kd(o),o.G==3){var u=o.U++,d=vt(o.I);if(ae(d,"SID",o.K),ae(d,"RID",u),ae(d,"TYPE","terminate"),Br(o,d),u=new xt(o,o.j,u),u.L=2,u.v=ys(vt(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=u.v,d=!0),d||(u.g=nf(u.j,null),u.g.ea(u.v)),u.F=Date.now(),ps(u)}ef(o)}function Is(o){o.g&&(Va(o),o.g.cancel(),o.g=null)}function Kd(o){Is(o),o.u&&(c.clearTimeout(o.u),o.u=null),Es(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function ws(o){if(!Cd(o.h)&&!o.s){o.s=!0;var u=o.Ga;Ar||sd(),br||(Ar(),br=!0),pa.add(u,o),o.B=0}}function Fv(o,u){return Pd(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Nr(_(o.Ga,o,u),Zd(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new xt(this,this.j,o),S=this.o;if(this.S&&(S?(S=g(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(T.H=S,S=null),this.P)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var f=this.i[d];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(u+=f,4096<u){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=Qd(this,T,u),d=vt(this.I),ae(d,"RID",o),ae(d,"CVER",22),this.D&&ae(d,"X-HTTP-Session-Id",this.D),Br(this,d),S&&(this.O?u="headers="+encodeURIComponent(String(jd(S)))+"&"+u:this.m&&xa(d,this.m,S)),Oa(this.h,T),this.Ua&&ae(d,"TYPE","init"),this.P?(ae(d,"$req",u),ae(d,"SID","null"),T.T=!0,Pa(T,d,null)):Pa(T,d,u),this.G=2}}else this.G==3&&(o?Hd(this,o):this.i.length==0||Cd(this.h)||Hd(this))};function Hd(o,u){var d;u?d=u.l:d=o.U++;let f=vt(o.I);ae(f,"SID",o.K),ae(f,"RID",d),ae(f,"AID",o.T),Br(o,f),o.m&&o.o&&xa(f,o.m,o.o),d=new xt(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),u&&(o.i=u.D.concat(o.i)),u=Qd(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Oa(o.h,d),Pa(d,f,u)}function Br(o,u){o.H&&ie(o.H,function(d,f){ae(u,f,d)}),o.l&&kd({},function(d,f){ae(u,f,d)})}function Qd(o,u,d){d=Math.min(o.i.length,d);var f=o.l?_(o.l.Na,o.l,o):null;e:{var T=o.i;let S=-1;for(;;){let k=["count="+d];S==-1?0<d?(S=T[0].g,k.push("ofs="+S)):S=0:k.push("ofs="+S);let se=!0;for(let Ee=0;Ee<d;Ee++){let X=T[Ee].g,Re=T[Ee].map;if(X-=S,0>X)S=Math.max(0,T[Ee].g-100),se=!1;else try{xv(Re,k,"req"+X+"_")}catch{f&&f(Re)}}if(se){f=k.join("&");break e}}}return o=o.i.splice(0,d),u.D=o,f}function Jd(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;Ar||sd(),br||(Ar(),br=!0),pa.add(u,o),o.v=0}}function La(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Nr(_(o.Fa,o),Zd(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Yd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Nr(_(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),Is(this),Yd(this))};function Va(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function Yd(o){o.g=new xt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=vt(o.qa);ae(u,"RID","rpc"),ae(u,"SID",o.K),ae(u,"AID",o.T),ae(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&ae(u,"TO",o.ja),ae(u,"TYPE","xmlhttp"),Br(o,u),o.m&&o.o&&xa(u,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=ys(vt(u)),d.m=null,d.P=!0,Ad(d,o)}n.Za=function(){this.C!=null&&(this.C=null,Is(this),La(this),Oe(19))};function Es(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function Xd(o,u){var d=null;if(o.g==u){Es(o),Va(o),o.g=null;var f=2}else if(ka(o.h,u))d=u.D,Dd(o.h,u),f=1;else return;if(o.G!=0){if(u.o)if(f==1){d=u.m?u.m.length:0,u=Date.now()-u.F;var T=o.B;f=hs(),ke(f,new Id(f,d)),ws(o)}else Jd(o);else if(T=u.s,T==3||T==0&&0<u.X||!(f==1&&Fv(o,u)||f==2&&La(o)))switch(d&&0<d.length&&(u=o.h,u.i=u.i.concat(d)),T){case 1:rn(o,5);break;case 4:rn(o,10);break;case 3:rn(o,6);break;default:rn(o,2)}}}function Zd(o,u){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*u}function rn(o,u){if(o.j.info("Error code "+u),u==2){var d=_(o.fb,o),f=o.Xa;let T=!f;f=new nn(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||gs(f,"https"),ys(f),T?Nv(f.toString(),d):kv(f.toString(),d)}else Oe(2);o.G=0,o.l&&o.l.sa(u),ef(o),Kd(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function ef(o){if(o.G=0,o.ka=[],o.l){let u=Nd(o.h);(u.length!=0||o.i.length!=0)&&(D(o.ka,u),D(o.ka,o.i),o.h.i.length=0,O(o.i),o.i.length=0),o.l.ra()}}function tf(o,u,d){var f=d instanceof nn?vt(d):new nn(d);if(f.g!="")u&&(f.g=u+"."+f.g),ms(f,f.s);else{var T=c.location;f=T.protocol,u=u?u+"."+T.hostname:T.hostname,T=+T.port;var S=new nn(null);f&&gs(S,f),u&&(S.g=u),T&&ms(S,T),d&&(S.l=d),f=S}return d=o.D,u=o.ya,d&&u&&ae(f,d,u),ae(f,"VER",o.la),Br(o,f),f}function nf(o,u,d){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new he(new Vr({eb:d})):new he(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rf(){}n=rf.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ts(){}Ts.prototype.g=function(o,u){return new Ue(o,u)};function Ue(o,u){Se.call(this),this.g=new Wd(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!z(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!z(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Pn(this)}C(Ue,Se),Ue.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ue.prototype.close=function(){Ma(this.g)},Ue.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=Ta(o),o=d);u.i.push(new wv(u.Ya++,o)),u.G==3&&ws(u)},Ue.prototype.N=function(){this.g.l=null,delete this.j,Ma(this.g),delete this.g,Ue.aa.N.call(this)};function sf(o){ba.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(let d in u){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}C(sf,ba);function of(){Sa.call(this),this.status=1}C(of,Sa);function Pn(o){this.g=o}C(Pn,rf),Pn.prototype.ua=function(){ke(this.g,"a")},Pn.prototype.ta=function(o){ke(this.g,new sf(o))},Pn.prototype.sa=function(o){ke(this.g,new of)},Pn.prototype.ra=function(){ke(this.g,"b")},Ts.prototype.createWebChannel=Ts.prototype.g,Ue.prototype.send=Ue.prototype.o,Ue.prototype.open=Ue.prototype.m,Ue.prototype.close=Ue.prototype.close,Xu=Rt.createWebChannelTransport=function(){return new Ts},Yu=Rt.getStatEventTarget=function(){return hs()},Ju=Rt.Event=en,wo=Rt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ds.NO_ERROR=0,ds.TIMEOUT=8,ds.HTTP_ERROR=6,Fi=Rt.ErrorCode=ds,wd.COMPLETE="complete",Qu=Rt.EventType=wd,md.EventType=Pr,Pr.OPEN="a",Pr.CLOSE="b",Pr.ERROR="c",Pr.MESSAGE="d",Se.prototype.listen=Se.prototype.K,er=Rt.WebChannel=md,Hu=Rt.FetchXmlHttpFactory=Vr,he.prototype.listenOnce=he.prototype.L,he.prototype.getLastError=he.prototype.Ka,he.prototype.getLastErrorCode=he.prototype.Ba,he.prototype.getStatus=he.prototype.Z,he.prototype.getResponseJson=he.prototype.Oa,he.prototype.getResponseText=he.prototype.oa,he.prototype.send=he.prototype.ea,he.prototype.setWithCredentials=he.prototype.Ha,Ku=Rt.XhrIo=he}).apply(typeof Io<"u"?Io:typeof self<"u"?self:typeof window<"u"?window:{});var fm="@firebase/firestore";var Ie=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ie.UNAUTHENTICATED=new Ie(null),Ie.GOOGLE_CREDENTIALS=new Ie("google-credentials-uid"),Ie.FIRST_PARTY=new Ie("first-party-uid"),Ie.MOCK_USER=new Ie("mock-user");var wr="10.13.2";var _n=new Gt("@firebase/firestore");function Ui(){return _n.logLevel}function x(n,...e){if(_n.logLevel<=K.DEBUG){let t=e.map(Mh);_n.debug(`Firestore (${wr}): ${n}`,...t)}}function Pt(n,...e){if(_n.logLevel<=K.ERROR){let t=e.map(Mh);_n.error(`Firestore (${wr}): ${n}`,...t)}}function ar(n,...e){if(_n.logLevel<=K.WARN){let t=e.map(Mh);_n.warn(`Firestore (${wr}): ${n}`,...t)}}function Mh(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function j(n="Unexpected state"){let e=`FIRESTORE (${wr}) INTERNAL ASSERTION FAILED: `+n;throw Pt(e),new Error(e)}function oe(n,e){n||j()}function $(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends Qe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ut=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var So=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},rl=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ie.UNAUTHENTICATED))}shutdown(){}},il=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},sl=class{constructor(e){this.t=e,this.currentUser=Ie.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new ut;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ut,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>R(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ut)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string"),new So(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string"),new Ie(e)}},ol=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ie.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},al=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ol(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ie.FIRST_PARTY))}shutdown(){}invalidateToken(){}},cl=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ul=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,x("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(oe(typeof t.token=="string"),this.R=t.token,new cl(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function _A(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ro=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=_A(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function cr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Ae=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ae(0,0))}static max(){return new n(new Ae(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Co=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&j(),r===void 0?r=e.length-t:r>e.length-t&&j(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},de=class n extends Co{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},IA=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ge=class n extends Co{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return IA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new L(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new L(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(de.fromString(e))}static fromName(e){return new n(de.fromString(e).popFirst(5))}static empty(){return new n(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return de.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new de(e.slice()))}};var ll=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};ll.UNKNOWN_ID=-1;function wA(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new Ae(t+1,0):new Ae(t,r));return new In(i,F.empty(),e)}function EA(n){return new In(n.readTime,n.key,-1)}var In=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),F.empty(),-1)}static max(){return new n(q.max(),F.empty(),-1)}};function TA(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}var AA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",hl=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function rs(n){return R(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==AA)throw n;x("LocalStore","Unexpectedly lost primary lease")})}var N=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),c=0;for(let l=0;l<s;l++){let h=l;t(e[h]).next(p=>{a[h]=p,++c,c===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function bA(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function is(n){return n.name==="IndexedDbTransactionError"}var zm=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function sa(n){return n==null}function Gi(n){return n===0&&1/n==-1/0}function SA(n){return typeof n=="number"&&Number.isInteger(n)&&!Gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var RA=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],NC=[...RA,"documentOverlays"],CA=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],PA=CA,DA=[...PA,"indexConfiguration","indexState","indexEntries"];var kC=[...DA,"globals"];function pm(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Gm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var fe=class n{constructor(e,t){this.comparator=e,this.root=t||lt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ir(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ir(this.root,e,this.comparator,!1)}getReverseIterator(){return new ir(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ir(this.root,e,this.comparator,!0)}},ir=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},lt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw j();let e=this.left.check();if(e!==this.right.check())throw j();return e+(this.isRed()?0:1)}};lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1;lt.EMPTY=new class{constructor(){this.size=0}get key(){throw j()}get value(){throw j()}get color(){throw j()}get left(){throw j()}get right(){throw j()}copy(e,t,r,i,s){return this}insert(e,t,r){return new lt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var De=class n{constructor(e){this.comparator=e,this.data=new fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Po(this.data.getIterator())}getIteratorFrom(e){return new Po(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Po=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Xe=class n{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new n([])}unionWith(e){let t=new De(Ge.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Do=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ne=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Do("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ne.EMPTY_BYTE_STRING=new Ne("");var NA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dt(n){if(oe(!!n),typeof n=="string"){let e=0,t=NA.exec(n);if(oe(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ue(n.seconds),nanos:ue(n.nanos)}}function ue(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Yt(n){return typeof n=="string"?Ne.fromBase64String(n):Ne.fromUint8Array(n)}function Lh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Vh(n){let e=n.mapValue.fields.__previous_value__;return Lh(e)?Vh(e):e}function Wi(n){let e=Dt(n.mapValue.fields.__local_write_time__.timestampValue);return new Ae(e.seconds,e.nanos)}var dl=class{constructor(e,t,r,i,s,a,c,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h}},No=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Eo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function wn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Lh(n)?4:Km(n)?9007199254740991:Wm(n)?10:11:j()}function pt(n,e){if(n===e)return!0;let t=wn(n);if(t!==wn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wi(n).isEqual(Wi(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Dt(i.timestampValue),c=Dt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Yt(i.bytesValue).isEqual(Yt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ue(i.geoPointValue.latitude)===ue(s.geoPointValue.latitude)&&ue(i.geoPointValue.longitude)===ue(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ue(i.integerValue)===ue(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=ue(i.doubleValue),c=ue(s.doubleValue);return a===c?Gi(a)===Gi(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return cr(n.arrayValue.values||[],e.arrayValue.values||[],pt);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(pm(a)!==pm(c))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!pt(a[l],c[l])))return!1;return!0}(n,e);default:return j()}}function Ki(n,e){return(n.values||[]).find(t=>pt(t,e))!==void 0}function ur(n,e){if(n===e)return 0;let t=wn(n),r=wn(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=ue(s.integerValue||s.doubleValue),l=ue(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return gm(n.timestampValue,e.timestampValue);case 4:return gm(Wi(n),Wi(e));case 5:return ee(n.stringValue,e.stringValue);case 6:return function(s,a){let c=Yt(s),l=Yt(a);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){let p=ee(c[h],l[h]);if(p!==0)return p}return ee(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=ee(ue(s.latitude),ue(a.latitude));return c!==0?c:ee(ue(s.longitude),ue(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return mm(n.arrayValue,e.arrayValue);case 10:return function(s,a){var c,l,h,p;let m=s.fields||{},_=a.fields||{},b=(c=m.value)===null||c===void 0?void 0:c.arrayValue,C=(l=_.value)===null||l===void 0?void 0:l.arrayValue,O=ee(((h=b?.values)===null||h===void 0?void 0:h.length)||0,((p=C?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:mm(b,C)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Eo.mapValue&&a===Eo.mapValue)return 0;if(s===Eo.mapValue)return 1;if(a===Eo.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),h=a.fields||{},p=Object.keys(h);l.sort(),p.sort();for(let m=0;m<l.length&&m<p.length;++m){let _=ee(l[m],p[m]);if(_!==0)return _;let b=ur(c[l[m]],h[p[m]]);if(b!==0)return b}return ee(l.length,p.length)}(n.mapValue,e.mapValue);default:throw j()}}function gm(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=Dt(n),r=Dt(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function mm(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=ur(t[i],r[i]);if(s)return s}return ee(t.length,r.length)}function lr(n){return fl(n)}function fl(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Dt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Yt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=fl(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${fl(t.fields[a])}`;return i+"}"}(n.mapValue):j()}function pl(n){return!!n&&"integerValue"in n}function Fh(n){return!!n&&"arrayValue"in n}function ym(n){return!!n&&"nullValue"in n}function vm(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ao(n){return!!n&&"mapValue"in n}function Wm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Bi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return bn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Bi(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Bi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Km(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var ze=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ao(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bi(t)}setAll(e){let t=Ge.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=Bi(a):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Ao(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return pt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ao(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){bn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Bi(this.value))}};function Hm(n){let e=[];return bn(n.fields,(t,r)=>{let i=new Ge([t]);if(Ao(r)){let s=Hm(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Xe(e)}var rt=class n{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),ze.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),ze.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var hr=class{constructor(e,t){this.position=e,this.inclusive=t}};function _m(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=ur(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Im(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!pt(n.position[t],e.position[t]))return!1;return!0}var dr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function kA(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ko=class{},ye=class n extends ko{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ml(e,t,r):t==="array-contains"?new _l(e,r):t==="in"?new Il(e,r):t==="not-in"?new wl(e,r):t==="array-contains-any"?new El(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new yl(e,r):new vl(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ur(t,this.value)):t!==null&&wn(this.value)===wn(t)&&this.matchesComparison(ur(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},gt=class n extends ko{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Qm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Qm(n){return n.op==="and"}function Jm(n){return OA(n)&&Qm(n)}function OA(n){for(let e of n.filters)if(e instanceof gt)return!1;return!0}function gl(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+lr(n.value);if(Jm(n))return n.filters.map(e=>gl(e)).join(",");{let e=n.filters.map(t=>gl(t)).join(",");return`${n.op}(${e})`}}function Ym(n,e){return n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&pt(r.value,i.value)}(n,e):n instanceof gt?function(r,i){return i instanceof gt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,c)=>s&&Ym(a,i.filters[c]),!0):!1}(n,e):void j()}function Xm(n){return n instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${lr(t.value)}`}(n):n instanceof gt?function(t){return t.op.toString()+" {"+t.getFilters().map(Xm).join(" ,")+"}"}(n):"Filter"}var ml=class extends ye{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},yl=class extends ye{constructor(e,t){super(e,"in",t),this.keys=Zm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},vl=class extends ye{constructor(e,t){super(e,"not-in",t),this.keys=Zm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Zm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}var _l=class extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Fh(t)&&Ki(t.arrayValue,this.value)}},Il=class extends ye{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ki(this.value.arrayValue,t)}},wl=class extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ki(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ki(this.value.arrayValue,t)}},El=class extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Fh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ki(this.value.arrayValue,r))}};var Tl=class{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.ue=null}};function wm(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Tl(n,e,t,r,i,s,a)}function Uh(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>gl(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),sa(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>lr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>lr(r)).join(",")),e.ue=t}return e.ue}function jh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!kA(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ym(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Im(n.startAt,e.startAt)&&Im(n.endAt,e.endAt)}function Al(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var fr=class{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function xA(n,e,t,r,i,s,a,c){return new fr(n,e,t,r,i,s,a,c)}function oa(n){return new fr(n)}function Em(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function MA(n){return n.collectionGroup!==null}function $i(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new De(Ge.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new dr(s,r))}),t.has(Ge.keyField().canonicalString())||e.ce.push(new dr(Ge.keyField(),r))}return e.ce}function ht(n){let e=$(n);return e.le||(e.le=LA(e,$i(n))),e.le}function LA(n,e){if(n.limitType==="F")return wm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new dr(i.field,s)});let t=n.endAt?new hr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hr(n.startAt.position,n.startAt.inclusive):null;return wm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function bl(n,e,t){return new fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function aa(n,e){return jh(ht(n),ht(e))&&n.limitType===e.limitType}function ey(n){return`${Uh(ht(n))}|lt:${n.limitType}`}function tr(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Xm(i)).join(", ")}]`),sa(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>lr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>lr(i)).join(",")),`Target(${r})`}(ht(n))}; limitType=${n.limitType})`}function ca(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of $i(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,c,l){let h=_m(a,c,l);return a.inclusive?h<=0:h<0}(r.startAt,$i(r),i)||r.endAt&&!function(a,c,l){let h=_m(a,c,l);return a.inclusive?h>=0:h>0}(r.endAt,$i(r),i))}(n,e)}function VA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ty(n){return(e,t)=>{let r=!1;for(let i of $i(n)){let s=FA(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function FA(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,a,c){let l=a.data.field(s),h=c.data.field(s);return l!==null&&h!==null?ur(l,h):j()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return j()}}var Xt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Gm(this.inner)}size(){return this.innerSize}};var UA=new fe(F.comparator);function Nt(){return UA}var ny=new fe(F.comparator);function ji(...n){let e=ny;for(let t of n)e=e.insert(t.key,t);return e}function ry(n){let e=ny;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function mn(){return qi()}function iy(){return qi()}function qi(){return new Xt(n=>n.toString(),(n,e)=>n.isEqual(e))}var jA=new fe(F.comparator),BA=new De(F.comparator);function H(...n){let e=BA;for(let t of n)e=e.add(t);return e}var $A=new De(ee);function qA(){return $A}function Bh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gi(e)?"-0":e}}function sy(n){return{integerValue:""+n}}function zA(n,e){return SA(e)?sy(e):Bh(n,e)}var pr=class{constructor(){this._=void 0}};function GA(n,e,t){return n instanceof gr?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Lh(s)&&(s=Vh(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof En?ay(n,e):n instanceof Tn?cy(n,e):function(i,s){let a=oy(i,s),c=Tm(a)+Tm(i.Pe);return pl(a)&&pl(i.Pe)?sy(c):Bh(i.serializer,c)}(n,e)}function WA(n,e,t){return n instanceof En?ay(n,e):n instanceof Tn?cy(n,e):t}function oy(n,e){return n instanceof mr?function(r){return pl(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var gr=class extends pr{},En=class extends pr{constructor(e){super(),this.elements=e}};function ay(n,e){let t=uy(e);for(let r of n.elements)t.some(i=>pt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Tn=class extends pr{constructor(e){super(),this.elements=e}};function cy(n,e){let t=uy(e);for(let r of n.elements)t=t.filter(i=>!pt(i,r));return{arrayValue:{values:t}}}var mr=class extends pr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Tm(n){return ue(n.integerValue||n.doubleValue)}function uy(n){return Fh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function KA(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof En&&i instanceof En||r instanceof Tn&&i instanceof Tn?cr(r.elements,i.elements,pt):r instanceof mr&&i instanceof mr?pt(r.Pe,i.Pe):r instanceof gr&&i instanceof gr}(n.transform,e.transform)}var Sl=class{constructor(e,t){this.version=e,this.transformResults=t}},Ct=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function bo(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var yr=class{};function ly(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hi(n.key,Ct.none()):new An(n.key,n.data,Ct.none());{let t=n.data,r=ze.empty(),i=new De(Ge.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new mt(n.key,r,new Xe(i.toArray()),Ct.none())}}function HA(n,e,t){n instanceof An?function(i,s,a){let c=i.value.clone(),l=bm(i.fieldTransforms,s,a.transformResults);c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof mt?function(i,s,a){if(!bo(i.precondition,s))return void s.convertToUnknownDocument(a.version);let c=bm(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(hy(i)),l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function zi(n,e,t,r){return n instanceof An?function(s,a,c,l){if(!bo(s.precondition,a))return c;let h=s.value.clone(),p=Sm(s.fieldTransforms,l,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof mt?function(s,a,c,l){if(!bo(s.precondition,a))return c;let h=Sm(s.fieldTransforms,l,a),p=a.data;return p.setAll(hy(s)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,c){return bo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function QA(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=oy(r.transform,i||null);s!=null&&(t===null&&(t=ze.empty()),t.set(r.field,s))}return t||null}function Am(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cr(r,i,(s,a)=>KA(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var An=class extends yr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},mt=class extends yr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function hy(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function bm(n,e,t){let r=new Map;oe(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,WA(a,c,t[i]))}return r}function Sm(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,GA(s,a,e))}return r}var Hi=class extends yr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Rl=class extends yr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Cl=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&HA(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=zi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=zi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=iy();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;let l=ly(a,c);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),H())}isEqual(e){return this.batchId===e.batchId&&cr(this.mutations,e.mutations,(t,r)=>Am(t,r))&&cr(this.baseMutations,e.baseMutations,(t,r)=>Am(t,r))}},Pl=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){oe(e.mutations.length===r.length);let i=function(){return jA}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Dl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Nl=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ge,Y;function JA(n){switch(n){default:return j();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function dy(n){if(n===void 0)return Pt("GRPC error has no .code"),P.UNKNOWN;switch(n){case ge.OK:return P.OK;case ge.CANCELLED:return P.CANCELLED;case ge.UNKNOWN:return P.UNKNOWN;case ge.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ge.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ge.INTERNAL:return P.INTERNAL;case ge.UNAVAILABLE:return P.UNAVAILABLE;case ge.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ge.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ge.NOT_FOUND:return P.NOT_FOUND;case ge.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ge.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ge.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ge.ABORTED:return P.ABORTED;case ge.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ge.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ge.DATA_LOSS:return P.DATA_LOSS;default:return j()}}(Y=ge||(ge={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";var Rm=null;function YA(){return new TextEncoder}var XA=new Qt([4294967295,4294967295],0);function Cm(n){let e=YA().encode(n),t=new Wu;return t.update(e),new Uint8Array(t.digest())}function Pm(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Qt([t,r],0),new Qt([i,s],0)]}var kl=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new yn(`Invalid padding: ${t}`);if(r<0)throw new yn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new yn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Qt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Qt.fromNumber(r)));return i.compare(XA)===1&&(i=new Qt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Cm(e),[r,i]=Pm(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;let t=Cm(e),[r,i]=Pm(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},yn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Oo=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Qi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new fe(ee),Nt(),H())}},Qi=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,H(),H(),H())}};var sr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},xo=class{constructor(e,t){this.targetId=e,this.me=t}},Mo=class{constructor(e,t,r=Ne.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Lo=class{constructor(){this.fe=0,this.ge=Nm(),this.pe=Ne.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=H(),t=H(),r=H();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:j()}}),new Qi(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Nm()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,oe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Ol=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Nt(),this.qe=Dm(),this.Qe=new fe(ee)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:j()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Al(s))if(r===0){let a=new F(s.path);this.Ue(t,a,rt.newNoDocument(a,q.min()))}else oe(r===1);else{let a=this.Ye(t);if(a!==r){let c=this.Ze(e),l=c?this.Xe(c,e,a):1;if(l!==0){this.je(t);let h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,h)}Rm?.et(function(p,m,_,b,C){var O,D,B,z,G,re;let we={localCacheCount:p,existenceFilterCount:m.count,databaseId:_.database,projectId:_.projectId},ie=m.unchangedNames;return ie&&(we.bloomFilter={applied:C===0,hashCount:(O=ie?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(z=(B=(D=ie?.bits)===null||D===void 0?void 0:D.bitmap)===null||B===void 0?void 0:B.length)!==null&&z!==void 0?z:0,padding:(re=(G=ie?.bits)===null||G===void 0?void 0:G.padding)!==null&&re!==void 0?re:0,mightContain:w=>{var g;return(g=b?.mightContain(w))!==null&&g!==void 0&&g}}),we}(a,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,c;try{a=Yt(r).toUint8Array()}catch(l){if(l instanceof Do)return ar("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new kl(a,i,s)}catch(l){return ar(l instanceof yn?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let c=this.Je(a);if(c){if(s.current&&Al(c.target)){let l=new F(c.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,rt.newNoDocument(l,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=H();this.qe.forEach((s,a)=>{let c=!0;a.forEachWhile(l=>{let h=this.Je(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new Oo(e,t,this.Qe,this.ke,r);return this.ke=Nt(),this.qe=Dm(),this.Qe=new fe(ee),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Lo,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new De(ee),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Lo),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Dm(){return new fe(F.comparator)}function Nm(){return new fe(F.comparator)}var ZA={asc:"ASCENDING",desc:"DESCENDING"},eb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tb={and:"AND",or:"OR"},xl=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ml(n,e){return n.useProto3Json||sa(e)?e:{value:e}}function Vo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fy(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function nb(n,e){return Vo(n,e.toTimestamp())}function dt(n){return oe(!!n),q.fromTimestamp(function(t){let r=Dt(t);return new Ae(r.seconds,r.nanos)}(n))}function $h(n,e){return Ll(n,e).canonicalString()}function Ll(n,e){let t=function(i){return new de(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function py(n){let e=de.fromString(n);return oe(_y(e)),e}function Vl(n,e){return $h(n.databaseId,e.path)}function Zu(n,e){let t=py(e);if(t.get(1)!==n.databaseId.projectId)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(my(t))}function gy(n,e){return $h(n.databaseId,e)}function rb(n){let e=py(n);return e.length===4?de.emptyPath():my(e)}function Fl(n){return new de(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function my(n){return oe(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function km(n,e,t){return{name:Vl(n,e),fields:t.value.mapValue.fields}}function ib(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:j()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(oe(p===void 0||typeof p=="string"),Ne.fromBase64String(p||"")):(oe(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ne.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){let p=h.code===void 0?P.UNKNOWN:dy(h.code);return new L(p,h.message||"")}(a);t=new Mo(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Zu(n,r.document.name),s=dt(r.document.updateTime),a=r.document.createTime?dt(r.document.createTime):q.min(),c=new ze({mapValue:{fields:r.document.fields}}),l=rt.newFoundDocument(i,s,a,c),h=r.targetIds||[],p=r.removedTargetIds||[];t=new sr(h,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Zu(n,r.document),s=r.readTime?dt(r.readTime):q.min(),a=rt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new sr([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Zu(n,r.document),s=r.removedTargetIds||[];t=new sr([],s,i,null)}else{if(!("filter"in e))return j();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Nl(i,s),c=r.targetId;t=new xo(c,a)}}return t}function sb(n,e){let t;if(e instanceof An)t={update:km(n,e.key,e.value)};else if(e instanceof Hi)t={delete:Vl(n,e.key)};else if(e instanceof mt)t={update:km(n,e.key,e.data),updateMask:pb(e.fieldMask)};else{if(!(e instanceof Rl))return j();t={verify:Vl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let c=a.transform;if(c instanceof gr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof En)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Tn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof mr)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw j()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:nb(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:j()}(n,e.precondition)),t}function ob(n,e){return n&&n.length>0?(oe(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?dt(i.updateTime):dt(s);return a.isEqual(q.min())&&(a=dt(s)),new Sl(a,i.transformResults||[])}(t,e))):[]}function ab(n,e){return{documents:[gy(n,e.path)]}}function cb(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=gy(n,i);let s=function(h){if(h.length!==0)return vy(gt.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:nr(_.field),direction:hb(_.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=Ml(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:t,parent:i}}function ub(n){let e=rb(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){oe(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){let _=yy(m);return _ instanceof gt&&Jm(_)?_.getFilters():[_]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(_=>function(C){return new dr(rr(C.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(_))}(t.orderBy));let c=null;t.limit&&(c=function(m){let _;return _=typeof m=="object"?m.value:m,sa(_)?null:_}(t.limit));let l=null;t.startAt&&(l=function(m){let _=!!m.before,b=m.values||[];return new hr(b,_)}(t.startAt));let h=null;return t.endAt&&(h=function(m){let _=!m.before,b=m.values||[];return new hr(b,_)}(t.endAt)),xA(e,i,a,s,c,"F",l,h)}function lb(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function yy(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=rr(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=rr(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=rr(t.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=rr(t.unaryFilter.field);return ye.create(a,"!=",{nullValue:"NULL_VALUE"});default:return j()}}(n):n.fieldFilter!==void 0?function(t){return ye.create(rr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return j()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return gt.create(t.compositeFilter.filters.map(r=>yy(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j()}}(t.compositeFilter.op))}(n):j()}function hb(n){return ZA[n]}function db(n){return eb[n]}function fb(n){return tb[n]}function nr(n){return{fieldPath:n.canonicalString()}}function rr(n){return Ge.fromServerFormat(n.fieldPath)}function vy(n){return n instanceof ye?function(t){if(t.op==="=="){if(vm(t.value))return{unaryFilter:{field:nr(t.field),op:"IS_NAN"}};if(ym(t.value))return{unaryFilter:{field:nr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vm(t.value))return{unaryFilter:{field:nr(t.field),op:"IS_NOT_NAN"}};if(ym(t.value))return{unaryFilter:{field:nr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nr(t.field),op:db(t.op),value:t.value}}}(n):n instanceof gt?function(t){let r=t.getFilters().map(i=>vy(i));return r.length===1?r[0]:{compositeFilter:{op:fb(t.op),filters:r}}}(n):j()}function pb(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function _y(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ji=class n{constructor(e,t,r,i,s=q.min(),a=q.min(),c=Ne.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ul=class{constructor(e){this.ct=e}};function gb(n){let e=ub({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bl(e,e.limit,"L"):e}var Fo=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ue(e.integerValue));else if("doubleValue"in e){let r=ue(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Gi(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Dt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Yt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Km(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Wm(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):j()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let a="value",c=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ue(c)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),F.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Fo.vt=new Fo;var jl=class{constructor(){this.un=new Bl}addToCollectionParentIndex(e,t){return this.un.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(In.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(In.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}},Bl=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new De(de.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new De(de.comparator)).toArray()}};var xC=new Uint8Array(0);var ct=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};ct.DEFAULT_COLLECTION_PERCENTILE=10,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ct.DEFAULT=new ct(41943040,ct.DEFAULT_COLLECTION_PERCENTILE,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ct.DISABLED=new ct(-1,0,0);var Yi=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var $l=class{constructor(){this.changes=new Xt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ql=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var zl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&zi(r.mutation,i,Xe.empty(),Ae.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,H()).next(()=>r))}getLocalViewOfDocuments(e,t,r=H()){let i=mn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=ji();return s.forEach((c,l)=>{a=a.insert(c,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=mn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,H()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let s=Nt(),a=qi(),c=function(){return qi()}();return t.forEach((l,h)=>{let p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof mt)?s=s.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),zi(p.mutation,h,p.mutation.getFieldMask(),Ae.now())):a.set(h.key,Xe.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,p)=>a.set(h,p)),t.forEach((h,p)=>{var m;return c.set(h,new ql(p,(m=a.get(h))!==null&&m!==void 0?m:null))}),c))}recalculateAndSaveOverlays(e,t){let r=qi(),i=new fe((a,c)=>a-c),s=H();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(l=>{let h=t.get(l);if(h===null)return;let p=r.get(l)||Xe.empty();p=c.applyToLocalView(h,p),r.set(l,p);let m=(i.get(c.batchId)||H()).add(l);i=i.insert(c.batchId,m)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),h=l.key,p=l.value,m=iy();p.forEach(_=>{if(!s.has(_)){let b=ly(t.get(_),r.get(_));b!==null&&m.set(_,b),s=s.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return N.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):MA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):N.resolve(mn()),c=-1,l=s;return a.next(h=>N.forEach(h,(p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(p)?N.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{l=l.insert(p,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,H())).next(p=>({batchId:c,changes:ry(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=ji();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=ji();return this.indexManager.getCollectionParents(e,s).next(c=>N.forEach(c,l=>{let h=function(m,_){return new fr(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((m,_)=>{a=a.insert(m,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,h)=>{let p=h.getKey();a.get(p)===null&&(a=a.insert(p,rt.newInvalidDocument(p)))});let c=ji();return a.forEach((l,h)=>{let p=s.get(l);p!==void 0&&zi(p.mutation,h,Xe.empty(),Ae.now()),ca(t,h)&&(c=c.insert(l,h))}),c})}};var Gl=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return N.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:dt(i.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:gb(i.bundledQuery),readTime:dt(i.readTime)}}(t)),N.resolve()}};var Wl=class{constructor(){this.overlays=new fe(F.comparator),this.Ir=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){let r=mn();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),N.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){let i=mn(),s=t.length+1,a=new F(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new fe((h,p)=>h-p),a=this.overlays.getIterator();for(;a.hasNext();){let h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=mn(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}let c=mn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,p)=>c.set(h,p)),!(c.size()>=i)););return N.resolve(c)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Dl(t,r));let s=this.Ir.get(t);s===void 0&&(s=H(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var Kl=class{constructor(){this.sessionToken=Ne.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}};var Xi=class{constructor(){this.Tr=new De(me.Er),this.dr=new De(me.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new me(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new me(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new F(new de([])),r=new me(t,e),i=new me(t,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new F(new de([])),r=new me(t,e),i=new me(t,e+1),s=H();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new me(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},me=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return F.comparator(e.key,t.key)||ee(e.wr,t.wr)}static Ar(e,t){return ee(e.wr,t.wr)||F.comparator(e.key,t.key)}};var Hl=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new De(me.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Cl(s,t,r,i);this.mutationQueue.push(a);for(let c of i)this.br=this.br.add(new me(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return N.resolve(a)}lookupMutationBatch(e,t){return N.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new me(t,0),i=new me(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{let c=this.Dr(a.wr);s.push(c)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new De(ee);return t.forEach(i=>{let s=new me(i,0),a=new me(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],c=>{r=r.add(c.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;F.isDocumentKey(s)||(s=s.child(""));let a=new me(new F(s),0),c=new De(ee);return this.br.forEachWhile(l=>{let h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(l.wr)),!0)},a),N.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){oe(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(t.mutations,i=>{let s=new me(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new me(t,0),i=this.br.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ql=class{constructor(e){this.Mr=e,this.docs=function(){return new fe(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():rt.newInvalidDocument(t))}getEntries(e,t){let r=Nt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():rt.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Nt(),a=t.path,c=new F(a.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:h,value:{document:p}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||TA(EA(p),r)<=0||(i.has(p.key)||ca(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,t,r,i){j()}Or(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Jl(this)}getSize(e){return N.resolve(this.size)}},Jl=class extends $l{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Yl=class{constructor(e){this.persistence=e,this.Nr=new Xt(t=>Uh(t),jh),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Xi,this.targetCount=0,this.kr=Yi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),N.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Yi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Kn(t),N.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),N.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Br.containsKey(t))}};var Xl=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new zm(0),this.Kr=!1,this.Kr=!0,this.$r=new Kl,this.referenceDelegate=e(this),this.Ur=new Yl(this),this.indexManager=new jl,this.remoteDocumentCache=function(i){return new Ql(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Ul(t),this.Gr=new Gl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Wl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Hl(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);let i=new Zl(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Zl=class extends hl{constructor(e){super(),this.currentSequenceNumber=e}},eh=class n{constructor(e){this.persistence=e,this.Jr=new Xi,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw j()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),N.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{let i=F.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,q.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return N.or([()=>N.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var th=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=H(),i=H();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var nh=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var rh=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Dg()?8:bA(qe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new nh;return this.Xi(e,t,a).next(c=>{if(s.result=c,this.zi)return this.es(e,t,a,c.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Ui()<=K.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",tr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(Ui()<=K.DEBUG&&x("QueryEngine","Query:",tr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ui()<=K.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",tr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ht(t))):N.resolve())}Yi(e,t){if(Em(t))return N.resolve(null);let r=ht(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=bl(t,null,"F"),r=ht(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=H(...s);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(l=>{let h=this.ts(t,c);return this.ns(t,h,a,l.readTime)?this.Yi(e,bl(t,null,"F")):this.rs(e,h,t,l)}))})))}Zi(e,t,r,i){return Em(t)||i.isEqual(q.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let a=this.ts(t,s);return this.ns(t,a,r,i)?N.resolve(null):(Ui()<=K.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tr(t)),this.rs(e,a,t,wA(i,-1)).next(c=>c))})}ts(e,t){let r=new De(ty(e));return t.forEach((i,s)=>{ca(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Ui()<=K.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",tr(t)),this.Ji.getDocumentsMatchingQuery(e,t,In.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var ih=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new fe(ee),this._s=new Xt(s=>Uh(s),jh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zl(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function mb(n,e,t,r){return new ih(n,e,t,r)}function Iy(n,e){return R(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],c=[],l=H();for(let h of i){a.push(h.batchId);for(let p of h.mutations)l=l.add(p.key)}for(let h of s){c.push(h.batchId);for(let p of h.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:c}))})})})}function yb(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,l,h,p){let m=h.batch,_=m.keys(),b=N.resolve();return _.forEach(C=>{b=b.next(()=>p.getEntry(l,C)).next(O=>{let D=h.docVersions.get(C);oe(D!==null),O.version.compareTo(D)<0&&(m.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),p.addEntry(O)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(l,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let l=H();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function wy(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function vb(n,e){let t=$(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let c=[];e.targetChanges.forEach((p,m)=>{let _=i.get(m);if(!_)return;c.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let b=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?b=b.withResumeToken(Ne.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,r)),i=i.insert(m,b),function(O,D,B){return O.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(_,b,p)&&c.push(t.Ur.updateTargetData(s,b))});let l=Nt(),h=H();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(_b(s,a,e.documentUpdates).next(p=>{l=p.Ps,h=p.Is})),!r.isEqual(q.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(p)}return N.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.os=i,s))}function _b(n,e,t){let r=H(),i=H();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Nt();return t.forEach((c,l)=>{let h=s.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(q.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):x("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function Ib(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wb(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new Ji(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function sh(n,e,t){return R(this,null,function*(){let r=$(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!is(a))throw a;x("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Om(n,e,t){let r=$(n),i=q.min(),s=H();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,h,p){let m=$(l),_=m._s.get(p);return _!==void 0?N.resolve(m.os.get(_)):m.Ur.getTargetData(h,p)}(r,a,ht(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,c.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:q.min(),t?s:H())).next(c=>(Eb(r,VA(e),c),{documents:c,Ts:s})))}function Eb(n,e,t){let r=n.us.get(e)||q.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Uo=class{constructor(){this.activeTargetIds=qA()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var oh=class{constructor(){this.so=new Uo,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Uo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ah=class{_o(e){}shutdown(){}};var jo=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var To=null;function el(){return To===null?To=function(){return 268435456+Math.round(2147483648*Math.random())}():To++,"0x"+To.toString(16)}var Tb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var ch=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Pe="WebChannelConnection",uh=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,a){let c=el(),l=this.xo(t,r.toUriEncodedString());x("RestConnection",`Sending RPC '${t}' ${c}:`,l,i);let h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,a),this.No(t,l,h,i).then(p=>(x("RestConnection",`Received RPC '${t}' ${c}: `,p),p),p=>{throw ar("RestConnection",`RPC '${t}' ${c} failed with error: `,p,"url: ",l,"request:",i),p})}Lo(t,r,i,s,a,c){return this.Mo(t,r,i,s,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,r){let i=Tb[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=el();return new Promise((a,c)=>{let l=new Ku;l.setWithCredentials(!0),l.listenOnce(Qu.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Fi.NO_ERROR:let p=l.getResponseJson();x(Pe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case Fi.TIMEOUT:x(Pe,`RPC '${e}' ${s} timed out`),c(new L(P.DEADLINE_EXCEEDED,"Request time out"));break;case Fi.HTTP_ERROR:let m=l.getStatus();if(x(Pe,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let _=l.getResponseJson();Array.isArray(_)&&(_=_[0]);let b=_?.error;if(b&&b.status&&b.message){let C=function(D){let B=D.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(B)>=0?B:P.UNKNOWN}(b.status);c(new L(C,b.message))}else c(new L(P.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new L(P.UNAVAILABLE,"Connection failed."));break;default:j()}}finally{x(Pe,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);x(Pe,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)})}Bo(e,t,r){let i=el(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Xu(),c=Yu(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.xmlHttpFactory=new Hu({})),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");x(Pe,`Creating RPC '${e}' stream ${i}: ${p}`,l);let m=a.createWebChannel(p,l),_=!1,b=!1,C=new ch({Io:D=>{b?x(Pe,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(_||(x(Pe,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),x(Pe,`RPC '${e}' stream ${i} sending:`,D),m.send(D))},To:()=>m.close()}),O=(D,B,z)=>{D.listen(B,G=>{try{z(G)}catch(re){setTimeout(()=>{throw re},0)}})};return O(m,er.EventType.OPEN,()=>{b||(x(Pe,`RPC '${e}' stream ${i} transport opened.`),C.yo())}),O(m,er.EventType.CLOSE,()=>{b||(b=!0,x(Pe,`RPC '${e}' stream ${i} transport closed`),C.So())}),O(m,er.EventType.ERROR,D=>{b||(b=!0,ar(Pe,`RPC '${e}' stream ${i} transport errored:`,D),C.So(new L(P.UNAVAILABLE,"The operation could not be completed")))}),O(m,er.EventType.MESSAGE,D=>{var B;if(!b){let z=D.data[0];oe(!!z);let G=z,re=G.error||((B=G[0])===null||B===void 0?void 0:B.error);if(re){x(Pe,`RPC '${e}' stream ${i} received error:`,re);let we=re.status,ie=function(v){let I=ge[v];if(I!==void 0)return dy(I)}(we),w=re.message;ie===void 0&&(ie=P.INTERNAL,w="Unknown error status: "+we+" with message "+re.message),b=!0,C.So(new L(ie,w)),m.close()}else x(Pe,`RPC '${e}' stream ${i} received:`,z),C.bo(z)}}),O(c,Ju.STAT_EVENT,D=>{D.stat===wo.PROXY?x(Pe,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===wo.NOPROXY&&x(Pe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}};function tl(){return typeof document<"u"?document:null}function ua(n){return new xl(n,!0)}var Bo=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var $o=class{constructor(e,t,r,i,s,a,c,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Bo(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return R(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return R(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return R(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(Pt(t.toString()),Pt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new L(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>R(this,null,function*(){this.state=0,this.start()}))}I_(e){return x("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},lh=class extends $o{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=ib(this.serializer,e),r=function(s){if(!("targetChange"in s))return q.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?dt(a.readTime):q.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Fl(this.serializer),t.addTarget=function(s,a){let c,l=a.target;if(c=Al(l)?{documents:ab(s,l)}:{query:cb(s,l)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=fy(s,a.resumeToken);let h=Ml(s,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(q.min())>0){c.readTime=Vo(s,a.snapshotVersion.toTimestamp());let h=Ml(s,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);let r=lb(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Fl(this.serializer),t.removeTarget=e,this.a_(t)}},hh=class extends $o{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return oe(!!e.streamToken),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){oe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=ob(e.writeResults,e.commitTime),r=dt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Fl(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>sb(this.serializer,r))};this.a_(t)}};var dh=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ll(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(P.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,Ll(t,r),i,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(P.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},fh=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Pt(t),this.D_=!1):x("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var ph=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(()=>R(this,null,function*(){Sn(this)&&(x("RemoteStore","Restarting streams for network reachability change."),yield function(l){return R(this,null,function*(){let h=$(l);h.L_.add(4),yield ss(h),h.q_.set("Unknown"),h.L_.delete(4),yield la(h)})}(this))}))}),this.q_=new fh(r,i)}};function la(n){return R(this,null,function*(){if(Sn(n))for(let e of n.B_)yield e(!0)})}function ss(n){return R(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Ey(n,e){let t=$(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Wh(t)?Gh(t):Er(t).r_()&&zh(t,e))}function qh(n,e){let t=$(n),r=Er(t);t.N_.delete(e),r.r_()&&Ty(t,e),t.N_.size===0&&(r.r_()?r.o_():Sn(t)&&t.q_.set("Unknown"))}function zh(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Er(n).A_(e)}function Ty(n,e){n.Q_.xe(e),Er(n).R_(e)}function Gh(n){n.Q_=new Ol({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Er(n).start(),n.q_.v_()}function Wh(n){return Sn(n)&&!Er(n).n_()&&n.N_.size>0}function Sn(n){return $(n).L_.size===0}function Ay(n){n.Q_=void 0}function Ab(n){return R(this,null,function*(){n.q_.set("Online")})}function bb(n){return R(this,null,function*(){n.N_.forEach((e,t)=>{zh(n,e)})})}function Sb(n,e){return R(this,null,function*(){Ay(n),Wh(n)?(n.q_.M_(e),Gh(n)):n.q_.set("Unknown")})}function Rb(n,e,t){return R(this,null,function*(){if(n.q_.set("Online"),e instanceof Mo&&e.state===2&&e.cause)try{yield function(i,s){return R(this,null,function*(){let a=s.cause;for(let c of s.targetIds)i.N_.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i.N_.delete(c),i.Q_.removeTarget(c))})}(n,e)}catch(r){x("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield qo(n,r)}else if(e instanceof sr?n.Q_.Ke(e):e instanceof xo?n.Q_.He(e):n.Q_.We(e),!t.isEqual(q.min()))try{let r=yield wy(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let c=s.Q_.rt(a);return c.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){let p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(l.resumeToken,a))}}),c.targetMismatches.forEach((l,h)=>{let p=s.N_.get(l);if(!p)return;s.N_.set(l,p.withResumeToken(Ne.EMPTY_BYTE_STRING,p.snapshotVersion)),Ty(s,l);let m=new Ji(p.target,l,h,p.sequenceNumber);zh(s,m)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){x("RemoteStore","Failed to raise snapshot:",r),yield qo(n,r)}})}function qo(n,e,t){return R(this,null,function*(){if(!is(e))throw e;n.L_.add(1),yield ss(n),n.q_.set("Offline"),t||(t=()=>wy(n.localStore)),n.asyncQueue.enqueueRetryable(()=>R(this,null,function*(){x("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield la(n)}))})}function by(n,e){return e().catch(t=>qo(n,t,e))}function ha(n){return R(this,null,function*(){let e=$(n),t=Zt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Cb(e);)try{let i=yield Ib(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,Pb(e,i)}catch(i){yield qo(e,i)}Sy(e)&&Ry(e)})}function Cb(n){return Sn(n)&&n.O_.length<10}function Pb(n,e){n.O_.push(e);let t=Zt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Sy(n){return Sn(n)&&!Zt(n).n_()&&n.O_.length>0}function Ry(n){Zt(n).start()}function Db(n){return R(this,null,function*(){Zt(n).p_()})}function Nb(n){return R(this,null,function*(){let e=Zt(n);for(let t of n.O_)e.m_(t.mutations)})}function kb(n,e,t){return R(this,null,function*(){let r=n.O_.shift(),i=Pl.from(r,e,t);yield by(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ha(n)})}function Ob(n,e){return R(this,null,function*(){e&&Zt(n).V_&&(yield function(r,i){return R(this,null,function*(){if(function(a){return JA(a)&&a!==P.ABORTED}(i.code)){let s=r.O_.shift();Zt(r).s_(),yield by(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ha(r)}})}(n,e)),Sy(n)&&Ry(n)})}function xm(n,e){return R(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");let r=Sn(t);t.L_.add(3),yield ss(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield la(t)})}function xb(n,e){return R(this,null,function*(){let t=$(n);e?(t.L_.delete(2),yield la(t)):e||(t.L_.add(2),yield ss(t),t.q_.set("Unknown"))})}function Er(n){return n.K_||(n.K_=function(t,r,i){let s=$(t);return s.w_(),new lh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:Ab.bind(null,n),Ro:bb.bind(null,n),mo:Sb.bind(null,n),d_:Rb.bind(null,n)}),n.B_.push(e=>R(this,null,function*(){e?(n.K_.s_(),Wh(n)?Gh(n):n.q_.set("Unknown")):(yield n.K_.stop(),Ay(n))}))),n.K_}function Zt(n){return n.U_||(n.U_=function(t,r,i){let s=$(t);return s.w_(),new hh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Db.bind(null,n),mo:Ob.bind(null,n),f_:Nb.bind(null,n),g_:kb.bind(null,n)}),n.B_.push(e=>R(this,null,function*(){e?(n.U_.s_(),yield ha(n)):(yield n.U_.stop(),n.O_.length>0&&(x("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var gh=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ut,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,c=new n(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Kh(n,e){if(Pt("AsyncQueue",`${e}: ${n}`),is(n))return new L(P.UNAVAILABLE,`${e}: ${n}`);throw n}var zo=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=ji(),this.sortedSet=new fe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Go=class{constructor(){this.W_=new fe(F.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):j():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},vr=class n{constructor(e,t,r,i,s,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,zo.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&aa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var mh=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},yh=class{constructor(){this.queries=Mm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=$(t),s=i.queries;i.queries=Mm(),s.forEach((a,c)=>{for(let l of c.j_)l.onError(r)})})(this,new L(P.ABORTED,"Firestore shutting down"))}};function Mm(){return new Xt(n=>ey(n),aa)}function Cy(n,e){return R(this,null,function*(){let t=$(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new mh,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=Kh(a,`Initialization of query '${tr(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Hh(t)})}function Py(n,e){return R(this,null,function*(){let t=$(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function Mb(n,e){let t=$(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let c of a.j_)c.X_(i)&&(r=!0);a.z_=i}}r&&Hh(t)}function Lb(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Hh(n){n.Y_.forEach(e=>{e.next()})}var vh,Lm;(Lm=vh||(vh={})).ea="default",Lm.Cache="cache";var Wo=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new vr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=vr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==vh.Cache}};var Ko=class{constructor(e){this.key=e}},Ho=class{constructor(e){this.key=e}},_h=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=H(),this.mutatedKeys=H(),this.Aa=ty(e),this.Ra=new zo(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Go,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{let _=i.get(p),b=ca(this.query,m)?m:null,C=!!_&&this.mutatedKeys.has(_.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),D=!1;_&&b?_.data.isEqual(b.data)?C!==O&&(r.track({type:3,doc:b}),D=!0):this.ga(_,b)||(r.track({type:2,doc:b}),D=!0,(l&&this.Aa(b,l)>0||h&&this.Aa(b,h)<0)&&(c=!0)):!_&&b?(r.track({type:0,doc:b}),D=!0):_&&!b&&(r.track({type:1,doc:_}),D=!0,(l||h)&&(c=!0)),D&&(b?(a=a.add(b),s=O?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,m)=>function(b,C){let O=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j()}};return O(b)-O(C)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;let c=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,h=l!==this.Ea;return this.Ea=l,a.length!==0||h?{snapshot:new vr(this.query,e.Ra,s,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Go,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=H(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Ho(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Ko(r))}),t}ba(e){this.Ta=e.Ts,this.da=H();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return vr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Ih=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},wh=class{constructor(e){this.key=e,this.va=!1}},Eh=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Xt(c=>ey(c),aa),this.Ma=new Map,this.xa=new Set,this.Oa=new fe(F.comparator),this.Na=new Map,this.La=new Xi,this.Ba={},this.ka=new Map,this.qa=Yi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Vb(n,e,t=!0){return R(this,null,function*(){let r=My(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield Dy(r,e,t,!0),i})}function Fb(n,e){return R(this,null,function*(){let t=My(n);yield Dy(t,e,!0,!1)})}function Dy(n,e,t,r){return R(this,null,function*(){let i=yield wb(n.localStore,ht(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield Ub(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ey(n.remoteStore,i),c})}function Ub(n,e,t,r,i){return R(this,null,function*(){n.Ka=(m,_,b)=>function(O,D,B,z){return R(this,null,function*(){let G=D.view.ma(B);G.ns&&(G=yield Om(O.localStore,D.query,!1).then(({documents:w})=>D.view.ma(w,G)));let re=z&&z.targetChanges.get(D.targetId),we=z&&z.targetMismatches.get(D.targetId)!=null,ie=D.view.applyChanges(G,O.isPrimaryClient,re,we);return Fm(O,D.targetId,ie.wa),ie.snapshot})}(n,m,_,b);let s=yield Om(n.localStore,e,!0),a=new _h(e,s.Ts),c=a.ma(s.documents),l=Qi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=a.applyChanges(c,n.isPrimaryClient,l);Fm(n,t,h.wa);let p=new Ih(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),h.snapshot})}function jb(n,e,t){return R(this,null,function*(){let r=$(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!aa(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield sh(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&qh(r.remoteStore,i.targetId),Th(r,i.targetId)}).catch(rs))):(Th(r,i.targetId),yield sh(r.localStore,i.targetId,!0))})}function Bb(n,e){return R(this,null,function*(){let t=$(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),qh(t.remoteStore,r.targetId))})}function $b(n,e,t){return R(this,null,function*(){let r=Qb(n);try{let i=yield function(a,c){let l=$(a),h=Ae.now(),p=c.reduce((b,C)=>b.add(C.key),H()),m,_;return l.persistence.runTransaction("Locally write mutations","readwrite",b=>{let C=Nt(),O=H();return l.cs.getEntries(b,p).next(D=>{C=D,C.forEach((B,z)=>{z.isValidDocument()||(O=O.add(B))})}).next(()=>l.localDocuments.getOverlayedDocuments(b,C)).next(D=>{m=D;let B=[];for(let z of c){let G=QA(z,m.get(z.key).overlayedDocument);G!=null&&B.push(new mt(z.key,G,Hm(G.value.mapValue),Ct.exists(!0)))}return l.mutationQueue.addMutationBatch(b,h,B,c)}).next(D=>{_=D;let B=D.applyToLocalDocumentSet(m,O);return l.documentOverlayCache.saveOverlays(b,D.batchId,B)})}).then(()=>({batchId:_.batchId,changes:ry(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,l){let h=a.Ba[a.currentUser.toKey()];h||(h=new fe(ee)),h=h.insert(c,l),a.Ba[a.currentUser.toKey()]=h}(r,i.batchId,t),yield os(r,i.changes),yield ha(r.remoteStore)}catch(i){let s=Kh(i,"Failed to persist write");t.reject(s)}})}function Ny(n,e){return R(this,null,function*(){let t=$(n);try{let r=yield vb(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(oe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?oe(a.va):i.removedDocuments.size>0&&(oe(a.va),a.va=!1))}),yield os(t,r,e)}catch(r){yield rs(r)}})}function Vm(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,a)=>{let c=a.view.Z_(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){let l=$(a);l.onlineState=c;let h=!1;l.queries.forEach((p,m)=>{for(let _ of m.j_)_.Z_(c)&&(h=!0)}),h&&Hh(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function qb(n,e,t){return R(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let a=new fe(F.comparator);a=a.insert(s,rt.newNoDocument(s,q.min()));let c=H().add(s),l=new Oo(q.min(),new Map,new fe(ee),a,c);yield Ny(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),Qh(r)}else yield sh(r.localStore,e,!1).then(()=>Th(r,e,t)).catch(rs)})}function zb(n,e){return R(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield yb(t.localStore,e);Oy(t,r,null),ky(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield os(t,i)}catch(i){yield rs(i)}})}function Gb(n,e,t){return R(this,null,function*(){let r=$(n);try{let i=yield function(a,c){let l=$(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return l.mutationQueue.lookupMutationBatch(h,c).next(m=>(oe(m!==null),p=m.keys(),l.mutationQueue.removeMutationBatch(h,m))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,p,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>l.localDocuments.getDocuments(h,p))})}(r.localStore,e);Oy(r,e,t),ky(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield os(r,i)}catch(i){yield rs(i)}})}function ky(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Oy(n,e,t){let r=$(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Th(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||xy(n,r)})}function xy(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(qh(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Qh(n))}function Fm(n,e,t){for(let r of t)r instanceof Ko?(n.La.addReference(r.key,e),Wb(n,r)):r instanceof Ho?(x("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||xy(n,r.key)):j()}function Wb(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(x("SyncEngine","New document in limbo: "+t),n.xa.add(r),Qh(n))}function Qh(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new F(de.fromString(e)),r=n.qa.next();n.Na.set(r,new wh(t)),n.Oa=n.Oa.insert(t,r),Ey(n.remoteStore,new Ji(ht(oa(t.path)),r,"TargetPurposeLimboResolution",zm.oe))}}function os(n,e,t){return R(this,null,function*(){let r=$(n),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((c,l)=>{a.push(r.Ka(l,e,t).then(h=>{var p;if((h||t)&&r.isPrimaryClient){let m=h?!h.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(h){i.push(h);let m=th.Wi(l.targetId,h);s.push(m)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(l,h){return R(this,null,function*(){let p=$(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>N.forEach(h,_=>N.forEach(_.$i,b=>p.persistence.referenceDelegate.addReference(m,_.targetId,b)).next(()=>N.forEach(_.Ui,b=>p.persistence.referenceDelegate.removeReference(m,_.targetId,b)))))}catch(m){if(!is(m))throw m;x("LocalStore","Failed to update sequence numbers: "+m)}for(let m of h){let _=m.targetId;if(!m.fromCache){let b=p.os.get(_),C=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(C);p.os=p.os.insert(_,O)}}})}(r.localStore,s))})}function Kb(n,e){return R(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){x("SyncEngine","User change. New user:",e.toKey());let r=yield Iy(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(c=>{c.forEach(l=>{l.reject(new L(P.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield os(t,r.hs)}})}function Hb(n,e){let t=$(n),r=t.Na.get(e);if(r&&r.va)return H().add(r.key);{let i=H(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let c=t.Fa.get(a);i=i.unionWith(c.view.Va)}return i}}function My(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ny.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qb.bind(null,e),e.Ca.d_=Mb.bind(null,e.eventManager),e.Ca.$a=Lb.bind(null,e.eventManager),e}function Qb(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Gb.bind(null,e),e}var Qo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return R(this,null,function*(){this.serializer=ua(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return mb(this.persistence,new rh,e.initialUser,this.serializer)}createPersistence(e){return new Xl(eh.Zr,this.serializer)}createSharedClientState(e){return new oh}terminate(){return R(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ah=class{initialize(e,t){return R(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Vm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kb.bind(null,this.syncEngine),yield xb(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new yh}()}createDatastore(e){let t=ua(e.databaseInfo.databaseId),r=function(s){return new uh(s)}(e.databaseInfo);return function(s,a,c,l){return new dh(s,a,c,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,c){return new ph(r,i,s,a,c)}(this.localStore,this.datastore,e.asyncQueue,t=>Vm(this.syncEngine,t,0),function(){return jo.D()?new jo:new ah}())}createSyncEngine(e,t){return function(i,s,a,c,l,h,p){let m=new Eh(i,s,a,c,l,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return R(this,null,function*(){var e,t;yield function(i){return R(this,null,function*(){let s=$(i);x("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield ss(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var Jo=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):Pt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var bh=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ie.UNAUTHENTICATED,this.clientId=Ro.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>R(this,null,function*(){x("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(x("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ut;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Kh(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function nl(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>R(this,null,function*(){r.isEqual(i)||(yield Iy(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Um(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Yb(n);x("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>xm(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>xm(e.remoteStore,i)),n._onlineComponents=e})}function Jb(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function Yb(n){return R(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x("FirestoreClient","Using user provided OfflineComponentProvider");try{yield nl(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!Jb(t))throw t;ar("Error using user provided cache. Falling back to memory cache: "+t),yield nl(n,new Qo)}}else x("FirestoreClient","Using default OfflineComponentProvider"),yield nl(n,new Qo);return n._offlineComponents})}function Ly(n){return R(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(x("FirestoreClient","Using user provided OnlineComponentProvider"),yield Um(n,n._uninitializedComponentsProvider._online)):(x("FirestoreClient","Using default OnlineComponentProvider"),yield Um(n,new Ah))),n._onlineComponents})}function Xb(n){return Ly(n).then(e=>e.syncEngine)}function Sh(n){return R(this,null,function*(){let e=yield Ly(n),t=e.eventManager;return t.onListen=Vb.bind(null,e.syncEngine),t.onUnlisten=jb.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Fb.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Bb.bind(null,e.syncEngine),t})}function Zb(n,e,t={}){let r=new ut;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(s,a,c,l,h){let p=new Jo({next:_=>{a.enqueueAndForget(()=>Py(s,m));let b=_.docs.has(c);!b&&_.fromCache?h.reject(new L(P.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&_.fromCache&&l&&l.source==="server"?h.reject(new L(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new Wo(oa(c.path),p,{includeMetadataChanges:!0,_a:!0});return Cy(s,m)}(yield Sh(n),n.asyncQueue,e,t,r)})),r.promise}function Vy(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var jm=new Map;function Fy(n,e,t){if(!t)throw new L(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function eS(n,e,t,r){if(e===!0&&r===!0)throw new L(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Bm(n){if(!F.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function $m(n){if(F.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":j()}function ft(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Jh(n);throw new L(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Yo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vy((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},_r=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new rl;switch(r.type){case"firstParty":return new al(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=jm.get(t);r&&(x("ComponentProvider","Removing Datastore"),jm.delete(t),r.terminate())}(this),Promise.resolve()}};function Uy(n,e,t,r={}){var i;let s=(n=ft(n,_r))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&ar("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let c,l;if(typeof r.mockUserToken=="string")c=r.mockUserToken,l=Ie.MOCK_USER;else{c=bg(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new L(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Ie(h)}n._authCredentials=new il(new So(c,l))}}var Xo=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Fe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Jt=class n extends Xo{constructor(e,t,r){super(e,t,oa(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function jy(n,e,...t){if(n=Le(n),Fy("collection","path",e),n instanceof _r){let r=de.fromString(e,...t);return $m(r),new Jt(n,null,r)}{if(!(n instanceof Fe||n instanceof Jt))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(de.fromString(e,...t));return $m(r),new Jt(n.firestore,null,r)}}function Yh(n,e,...t){if(n=Le(n),arguments.length===1&&(e=Ro.newId()),Fy("doc","path",e),n instanceof _r){let r=de.fromString(e,...t);return Bm(r),new Fe(n,null,new F(r))}{if(!(n instanceof Fe||n instanceof Jt))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(de.fromString(e,...t));return Bm(r),new Fe(n.firestore,n instanceof Jt?n.converter:null,new F(r))}}var Rh=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new Bo(this,"async_queue_retry"),this.Eu=()=>{let t=tl();t&&x("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=tl();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=tl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new ut;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return R(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!is(e))throw e;x("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Pt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=gh.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&j()}verifyOperationInProgress(){}mu(){return R(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function qm(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var kt=class extends _r{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Rh}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||$y(this),this._firestoreClient.terminate()}};function By(n,e){let t=typeof n=="object"?n:Ci(),r=typeof n=="string"?n:e||"(default)",i=Ru(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Tg("firestore");s&&Uy(i,...s)}return i}function Xh(n){return n._firestoreClient||$y(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function $y(n){var e,t,r;let i=n._freezeSettings(),s=function(c,l,h,p){return new dl(c,l,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Vy(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new bh(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Zi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ne.fromBase64String(e))}catch(t){throw new L(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ne.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ir=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var es=class{constructor(e){this._methodName=e}};var ts=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var ns=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var tS=/^__.*__$/,Ch=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new mt(e,this.data,this.fieldMask,t,this.fieldTransforms):new An(e,this.data,t,this.fieldTransforms)}},Zo=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new mt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function qy(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j()}}var Ph=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return ta(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(qy(this.wu)&&tS.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Dh=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ua(e)}Nu(e,t,r,i=!1){return new Ph({wu:e,methodName:t,Ou:r,path:Ge.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function zy(n){let e=n._freezeSettings(),t=ua(n._databaseId);return new Dh(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nS(n,e,t,r,i,s={}){let a=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);Zh("Data must be an object, but it was:",a,r);let c=Gy(r,a),l,h;if(s.merge)l=new Xe(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let m of s.mergeFields){let _=Nh(e,m,t);if(!a.contains(_))throw new L(P.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Ky(p,_)||p.push(_)}l=new Xe(p),h=a.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,h=a.fieldTransforms;return new Ch(new ze(c),l,h)}var ea=class n extends es{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function rS(n,e,t,r){let i=n.Nu(1,e,t);Zh("Data must be an object, but it was:",i,r);let s=[],a=ze.empty();bn(r,(l,h)=>{let p=ed(e,l,t);h=Le(h);let m=i.Cu(p);if(h instanceof ea)s.push(p);else{let _=da(h,m);_!=null&&(s.push(p),a.set(p,_))}});let c=new Xe(s);return new Zo(a,c,i.fieldTransforms)}function iS(n,e,t,r,i,s){let a=n.Nu(1,e,t),c=[Nh(e,r,t)],l=[i];if(s.length%2!=0)throw new L(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)c.push(Nh(e,s[_])),l.push(s[_+1]);let h=[],p=ze.empty();for(let _=c.length-1;_>=0;--_)if(!Ky(h,c[_])){let b=c[_],C=l[_];C=Le(C);let O=a.Cu(b);if(C instanceof ea)h.push(b);else{let D=da(C,O);D!=null&&(h.push(b),p.set(b,D))}}let m=new Xe(h);return new Zo(p,m,a.fieldTransforms)}function da(n,e){if(Wy(n=Le(n)))return Zh("Unsupported field value:",e,n),Gy(n,e);if(n instanceof es)return function(r,i){if(!qy(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let c of r){let l=da(c,i.Fu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Le(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return zA(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ae.fromDate(r);return{timestampValue:Vo(i.serializer,s)}}if(r instanceof Ae){let s=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vo(i.serializer,s)}}if(r instanceof ts)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zi)return{bytesValue:fy(i.serializer,r._byteString)};if(r instanceof Fe){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$h(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ns)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw c.Mu("VectorValues must only contain numeric values.");return Bh(c.serializer,l)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Jh(r)}`)}(n,e)}function Gy(n,e){let t={};return Gm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bn(n,(r,i)=>{let s=da(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function Wy(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ae||n instanceof ts||n instanceof Zi||n instanceof Fe||n instanceof es||n instanceof ns)}function Zh(n,e,t){if(!Wy(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Jh(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function Nh(n,e,t){if((e=Le(e))instanceof Ir)return e._internalPath;if(typeof e=="string")return ed(n,e);throw ta("Field path arguments must be of type string or ",n,!1,void 0,t)}var sS=new RegExp("[~\\*/\\[\\]]");function ed(n,e,t){if(e.search(sS)>=0)throw ta(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ir(...e.split("."))._internalPath}catch{throw ta(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ta(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new L(P.INVALID_ARGUMENT,c+n+l)}function Ky(n,e){return n.some(t=>t.isEqual(e))}var na=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new kh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Hy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},kh=class extends na{data(){return super.data()}};function Hy(n,e){return typeof e=="string"?ed(n,e):e instanceof Ir?e._internalPath:e._delegate._internalPath}function oS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Oh=class{convertValue(e,t="none"){switch(wn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ue(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return bn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ue(a.doubleValue));return new ns(s)}convertGeoPoint(e){return new ts(ue(e.latitude),ue(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Vh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Wi(e));default:return null}}convertTimestamp(e){let t=Dt(e);return new Ae(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=de.fromString(e);oe(_y(r));let i=new No(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||Pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function aS(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var vn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ra=class extends na{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new or(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Hy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},or=class extends ra{data(e={}){return super.data(e)}},xh=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new vn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new or(this._firestore,this._userDataWriter,r.key,r,new vn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let l=new or(i._firestore,i._userDataWriter,c.doc.key,c.doc,new vn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new or(i._firestore,i._userDataWriter,c.doc.key,c.doc,new vn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,p=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:cS(c.type),doc:l,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function cS(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j()}}function Qy(n){n=ft(n,Fe);let e=ft(n.firestore,kt);return Zb(Xh(e),n._key).then(t=>Zy(e,n,t))}var ia=class extends Oh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,t)}};function Jy(n,e,t,...r){n=ft(n,Fe);let i=ft(n.firestore,kt),s=zy(i),a;return a=typeof(e=Le(e))=="string"||e instanceof Ir?iS(s,"updateDoc",n._key,e,t,r):rS(s,"updateDoc",n._key,e),nd(i,[a.toMutation(n._key,Ct.exists(!0))])}function Yy(n){return nd(ft(n.firestore,kt),[new Hi(n._key,Ct.none())])}function Xy(n,e){let t=ft(n.firestore,kt),r=Yh(n),i=aS(n.converter,e);return nd(t,[nS(zy(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ct.exists(!1))]).then(()=>r)}function td(n,...e){var t,r,i;n=Le(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||qm(e[a])||(s=e[a],a++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(qm(e[a])){let m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let l,h,p;if(n instanceof Fe)h=ft(n.firestore,kt),p=oa(n._key.path),l={next:m=>{e[a]&&e[a](Zy(h,n,m))},error:e[a+1],complete:e[a+2]};else{let m=ft(n,Xo);h=ft(m.firestore,kt),p=m._query;let _=new ia(h);l={next:b=>{e[a]&&e[a](new xh(h,_,m,b))},error:e[a+1],complete:e[a+2]},oS(n._query)}return function(_,b,C,O){let D=new Jo(O),B=new Wo(b,D,C);return _.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Cy(yield Sh(_),B)})),()=>{D.za(),_.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Py(yield Sh(_),B)}))}}(Xh(h),p,c,l)}function nd(n,e){return function(r,i){let s=new ut;return r.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return $b(yield Xb(r),i,s)})),s.promise}(Xh(n),e)}function Zy(n,e,t){let r=t.docs.get(e._key),i=new ia(n);return new ra(n,i,e._key,r,new vn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){wr=i})(Yn),Kt(new Je("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),c=new kt(new sl(r.getProvider("auth-internal")),new ul(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new No(h.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),_e(fm,"4.7.2",e),_e(fm,"4.7.2","esm2017")})();var fa=function(){return fa=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},fa.apply(this,arguments)};var hS={includeMetadataChanges:!1};function ev(n,e){return e===void 0&&(e=hS),new Nn(function(t){var r=td(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function tv(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:fa(fa({},r),(t={},t[e.idField]=n.id,t))}function nv(n){return ev(n,{includeMetadataChanges:!0}).pipe(Q(function(e){return e.docs}))}function rv(n,e){return e===void 0&&(e={}),nv(n).pipe(Q(function(t){return t.map(function(r){return tv(r,e)})}))}var as=class{constructor(e){return e}},iv="firestore",rd=class{constructor(){return Di(iv)}};var id=new ce("angularfire2.firestore-instances");function dS(n,e){let t=Du(iv,n,e);return t&&new as(t)}function fS(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new as(r)}}var pS={provide:rd,deps:[[new et,id]]},gS={provide:as,useFactory:dS,deps:[[new et,id],fn]};function hD(n,...e){return _e("angularfire",Zn.full,"fst"),It([gS,pS,{provide:id,useFactory:fS(n),multi:!0,deps:[Me,sn,Ni,ki,[new et,_o],[new et,Pi],...e]}])}var dD=Ye(rv,!0);var fD=Ye(Xy,!0);var pD=Ye(jy,!0);var gD=Ye(Yy,!0);var mD=Ye(Yh,!0);var yD=Ye(Qy,!0);var vD=Ye(By,!0);var _D=Ye(Jy,!0);export{SS as a,_p as b,QS as c,w_ as d,JS as e,qt as f,Z_ as g,At as h,_R as i,IR as j,wR as k,l0 as l,h0 as m,as as n,hD as o,dD as p,fD as q,pD as r,gD as s,mD as t,yD as u,vD as v,_D as w};
